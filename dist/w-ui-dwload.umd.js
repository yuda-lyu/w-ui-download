/*!
 * w-ui-dwload v1.0.3
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("xlsx")):"function"==typeof define&&define.amd?define(["xlsx"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-ui-dwload"]=e(t.XLSX)}(this,(function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=e(t);function n(t,e,r,n,o,a,i){try{var u=t[a](i),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise((function(o,a){var i=t.apply(e,r);function u(t){n(i,o,a,u,c,"next",t)}function c(t){n(i,o,a,u,c,"throw",t)}u(void 0)}))}}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function u(t){var e={exports:{}};return t(e,e.exports),e.exports}var c=u((function(t){var e=function(t){var e,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,a=Object.create(o.prototype),i=new E(n||[]);return a._invoke=function(t,e,r){var n=v;return function(o,a){if(n===h)throw new Error("Generator is already running");if(n===d){if("throw"===o)throw a;return T()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var u=S(i,r);if(u){if(u===y)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===v)throw n=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=h;var c=s(t,e,r);if("normal"===c.type){if(n=r.done?d:p,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=d,r.method="throw",r.arg=c.arg)}}}(t,r,i),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var v="suspendedStart",p="suspendedYield",h="executing",d="completed",y={};function b(){}function g(){}function m(){}var w={};f(w,i,(function(){return this}));var j=Object.getPrototypeOf,x=j&&j(j(P([])));x&&x!==r&&n.call(x,i)&&(w=x);var _=m.prototype=b.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,u,c){var f=s(t[o],t,i);if("throw"!==f.type){var l=f.arg,v=l.value;return v&&"object"===a(v)&&n.call(v,"__await")?e.resolve(v.__await).then((function(t){r("next",t,u,c)}),(function(t){r("throw",t,u,c)})):e.resolve(v).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,c)}))}c(f.arg)}var o;this._invoke=function(t,n){function a(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(a,a):a()}}function S(t,r){var n=t.iterator[r.method];if(n===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,S(t,r),"throw"===r.method))return y;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=s(n,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(t){if(t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}return{next:T}}function T(){return{value:e,done:!0}}return g.prototype=m,f(_,"constructor",m),f(m,"constructor",g),g.displayName=f(m,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,f(t,c,"GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},O(k.prototype),f(k.prototype,u,(function(){return this})),t.AsyncIterator=k,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new k(l(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},O(_),f(_,c,"Generator"),f(_,i,(function(){return this})),f(_,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=P,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return u.type="throw",u.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],u=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),f=n.call(i,"finallyLoc");if(c&&f){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"===("undefined"==typeof globalThis?"undefined":a(globalThis))?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})),f=c,l=Array.isArray,s="object"==a(i)&&i&&i.Object===Object&&i,v="object"==("undefined"==typeof self?"undefined":a(self))&&self&&self.Object===Object&&self,p=s||v||Function("return this")(),h=p.Symbol,d=Object.prototype,y=d.hasOwnProperty,b=d.toString,g=h?h.toStringTag:void 0;var m=function(t){var e=y.call(t,g),r=t[g];try{t[g]=void 0;var n=!0}catch(t){}var o=b.call(t);return n&&(e?t[g]=r:delete t[g]),o},w=Object.prototype.toString;var j=function(t){return w.call(t)},x=h?h.toStringTag:void 0;var _=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":x&&x in Object(t)?m(t):j(t)};var O=function(t){return null!=t&&"object"==a(t)};var k=function(t){return"symbol"==a(t)||O(t)&&"[object Symbol]"==_(t)},S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,L=/^\w*$/;var A=function(t,e){if(l(t))return!1;var r=a(t);return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!k(t))||(L.test(t)||!S.test(t)||null!=e&&t in Object(e))};var E=function(t){var e=a(t);return null!=t&&("object"==e||"function"==e)};var P,T=function(t){if(!E(t))return!1;var e=_(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},N=p["__core-js_shared__"],F=(P=/[^.]+$/.exec(N&&N.keys&&N.keys.IE_PROTO||""))?"Symbol(src)_1."+P:"";var I=function(t){return!!F&&F in t},z=Function.prototype.toString;var U=function(t){if(null!=t){try{return z.call(t)}catch(t){}try{return t+""}catch(t){}}return""},B=/^\[object .+?Constructor\]$/,C=Function.prototype,R=Object.prototype,D=C.toString,$=R.hasOwnProperty,M=RegExp("^"+D.call($).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var G=function(t){return!(!E(t)||I(t))&&(T(t)?M:B).test(U(t))};var q=function(t,e){return null==t?void 0:t[e]};var V=function(t,e){var r=q(t,e);return G(r)?r:void 0},X=V(Object,"create");var J=function(){this.__data__=X?X(null):{},this.size=0};var W=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Y=Object.prototype.hasOwnProperty;var H=function(t){var e=this.__data__;if(X){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return Y.call(e,t)?e[t]:void 0},K=Object.prototype.hasOwnProperty;var Q=function(t){var e=this.__data__;return X?void 0!==e[t]:K.call(e,t)};var Z=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=X&&void 0===e?"__lodash_hash_undefined__":e,this};function tt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}tt.prototype.clear=J,tt.prototype.delete=W,tt.prototype.get=H,tt.prototype.has=Q,tt.prototype.set=Z;var et=tt;var rt=function(){this.__data__=[],this.size=0};var nt=function(t,e){return t===e||t!=t&&e!=e};var ot=function(t,e){for(var r=t.length;r--;)if(nt(t[r][0],e))return r;return-1},at=Array.prototype.splice;var it=function(t){var e=this.__data__,r=ot(e,t);return!(r<0)&&(r==e.length-1?e.pop():at.call(e,r,1),--this.size,!0)};var ut=function(t){var e=this.__data__,r=ot(e,t);return r<0?void 0:e[r][1]};var ct=function(t){return ot(this.__data__,t)>-1};var ft=function(t,e){var r=this.__data__,n=ot(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function lt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}lt.prototype.clear=rt,lt.prototype.delete=it,lt.prototype.get=ut,lt.prototype.has=ct,lt.prototype.set=ft;var st=lt,vt=V(p,"Map");var pt=function(){this.size=0,this.__data__={hash:new et,map:new(vt||st),string:new et}};var ht=function(t){var e=a(t);return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var dt=function(t,e){var r=t.__data__;return ht(e)?r["string"==typeof e?"string":"hash"]:r.map};var yt=function(t){var e=dt(this,t).delete(t);return this.size-=e?1:0,e};var bt=function(t){return dt(this,t).get(t)};var gt=function(t){return dt(this,t).has(t)};var mt=function(t,e){var r=dt(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function wt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}wt.prototype.clear=pt,wt.prototype.delete=yt,wt.prototype.get=bt,wt.prototype.has=gt,wt.prototype.set=mt;var jt=wt;function xt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function r(){var n=arguments,o=e?e.apply(this,n):n[0],a=r.cache;if(a.has(o))return a.get(o);var i=t.apply(this,n);return r.cache=a.set(o,i)||a,i};return r.cache=new(xt.Cache||jt),r}xt.Cache=jt;var _t=xt;var Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,kt=/\\(\\)?/g,St=function(t){var e=_t(t,(function(t){return 500===r.size&&r.clear(),t})),r=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Ot,(function(t,r,n,o){e.push(n?o.replace(kt,"$1"):r||t)})),e}));var Lt=function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o},At=h?h.prototype:void 0,Et=At?At.toString:void 0;var Pt=function t(e){if("string"==typeof e)return e;if(l(e))return Lt(e,t)+"";if(k(e))return Et?Et.call(e):"";var r=e+"";return"0"==r&&1/e==-Infinity?"-0":r};var Tt=function(t){return null==t?"":Pt(t)};var Nt=function(t,e){return l(t)?t:A(t,e)?[t]:St(Tt(t))};var Ft=function(t){if("string"==typeof t||k(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e};var It=function(t,e){for(var r=0,n=(e=Nt(e,t)).length;null!=t&&r<n;)t=t[Ft(e[r++])];return r&&r==n?t:void 0};var zt=function(t,e,r){var n=null==t?void 0:It(t,e);return void 0===n?r:n};var Ut=function(t){return"number"==typeof t||O(t)&&"[object Number]"==_(t)};function Bt(){var t,e,r=new Promise((function(){t=arguments[0],e=arguments[1]}));return r.resolve=t,r.reject=e,r}function Ct(t){return"[object String]"===Object.prototype.toString.call(t)}function Rt(t){return!(!Ct(t)||""===t)}function Dt(t){var e=!1;return Rt(t)?e=!isNaN(Number(t)):function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)&&(e=!0),e}function $t(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;Dt(t)||(t=10);var e=Bt();return setTimeout((function(){e.resolve()}),t),e}function Mt(t){return"[object Array]"===Object.prototype.toString.call(t)}function Gt(t){var e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}var qt=function(t){return!0===t||!1===t||O(t)&&"[object Boolean]"==_(t)};function Vt(t){return qt(t)}function Xt(t){return"[object Undefined]"===Object.prototype.toString.call(t)}function Jt(t){return"[object Object]"===Object.prototype.toString.call(t)}function Wt(t){return!!Xt(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(Jt(t)){for(var e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!Ct(t)||""!==t)}(t)||!!function(t){return!!Mt(t)&&0===t.length}(t))))}function Yt(t){return!!Mt(t)&&(0!==t.length&&(1!==t.length||!Wt(t[0])))}function Ht(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)}var Kt=function(t,e){return function(r){return t(e(r))}},Qt=Kt(Object.getPrototypeOf,Object),Zt=Function.prototype,te=Object.prototype,ee=Zt.toString,re=te.hasOwnProperty,ne=ee.call(Object);var oe=function(t){if(!O(t)||"[object Object]"!=_(t))return!1;var e=Qt(t);if(null===e)return!0;var r=re.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&ee.call(r)==ne};var ae=function(t){return O(t)&&1===t.nodeType&&!oe(t)};function ie(t){return ae(t)}function ue(t){var e,r=Object.prototype.toString.call(t);if(e="[object Promise]"===r)return!0;if("[object Function]"!==r)return!1;try{e="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return e}function ce(t,e){return!!Jt(t)&&(!(!Rt(e)&&!Dt(e))&&e in t)}function fe(t,e){var r=new Blob([t],{type:e});try{var n=window.URL.createObjectURL(r);window.open(n)}catch(t){console.log("window.URL.createObjectURL is not support for IE11",t)}}var le=function(){this.__data__=new st,this.size=0};var se=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r};var ve=function(t){return this.__data__.get(t)};var pe=function(t){return this.__data__.has(t)};var he=function(t,e){var r=this.__data__;if(r instanceof st){var n=r.__data__;if(!vt||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new jt(n)}return r.set(t,e),this.size=r.size,this};function de(t){var e=this.__data__=new st(t);this.size=e.size}de.prototype.clear=le,de.prototype.delete=se,de.prototype.get=ve,de.prototype.has=pe,de.prototype.set=he;var ye=de;var be=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};var ge=function(t){return this.__data__.has(t)};function me(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new jt;++e<r;)this.add(t[e])}me.prototype.add=me.prototype.push=be,me.prototype.has=ge;var we=me;var je=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1};var xe=function(t,e){return t.has(e)};var _e=function(t,e,r,n,o,a){var i=1&r,u=t.length,c=e.length;if(u!=c&&!(i&&c>u))return!1;var f=a.get(t),l=a.get(e);if(f&&l)return f==e&&l==t;var s=-1,v=!0,p=2&r?new we:void 0;for(a.set(t,e),a.set(e,t);++s<u;){var h=t[s],d=e[s];if(n)var y=i?n(d,h,s,e,t,a):n(h,d,s,t,e,a);if(void 0!==y){if(y)continue;v=!1;break}if(p){if(!je(e,(function(t,e){if(!xe(p,e)&&(h===t||o(h,t,r,n,a)))return p.push(e)}))){v=!1;break}}else if(h!==d&&!o(h,d,r,n,a)){v=!1;break}}return a.delete(t),a.delete(e),v},Oe=p.Uint8Array;var ke=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r};var Se=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r},Le=h?h.prototype:void 0,Ae=Le?Le.valueOf:void 0;var Ee=function(t,e,r,n,o,a,i){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!a(new Oe(t),new Oe(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return nt(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var u=ke;case"[object Set]":var c=1&n;if(u||(u=Se),t.size!=e.size&&!c)return!1;var f=i.get(t);if(f)return f==e;n|=2,i.set(t,e);var l=_e(u(t),u(e),n,o,a,i);return i.delete(t),l;case"[object Symbol]":if(Ae)return Ae.call(t)==Ae.call(e)}return!1};var Pe=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t};var Te=function(t,e,r){var n=e(t);return l(t)?n:Pe(n,r(t))};var Ne=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,a=[];++r<n;){var i=t[r];e(i,r,t)&&(a[o++]=i)}return a};var Fe=function(){return[]},Ie=Object.prototype.propertyIsEnumerable,ze=Object.getOwnPropertySymbols,Ue=ze?function(t){return null==t?[]:(t=Object(t),Ne(ze(t),(function(e){return Ie.call(t,e)})))}:Fe;var Be=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n};var Ce=function(t){return O(t)&&"[object Arguments]"==_(t)},Re=Object.prototype,De=Re.hasOwnProperty,$e=Re.propertyIsEnumerable,Me=Ce(function(){return arguments}())?Ce:function(t){return O(t)&&De.call(t,"callee")&&!$e.call(t,"callee")},Ge=Me;var qe=function(){return!1},Ve=u((function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r?p.Buffer:void 0,a=(o?o.isBuffer:void 0)||qe;t.exports=a})),Xe=/^(?:0|[1-9]\d*)$/;var Je=function(t,e){var r=a(t);return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&Xe.test(t))&&t>-1&&t%1==0&&t<e};var We=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},Ye={};Ye["[object Float32Array]"]=Ye["[object Float64Array]"]=Ye["[object Int8Array]"]=Ye["[object Int16Array]"]=Ye["[object Int32Array]"]=Ye["[object Uint8Array]"]=Ye["[object Uint8ClampedArray]"]=Ye["[object Uint16Array]"]=Ye["[object Uint32Array]"]=!0,Ye["[object Arguments]"]=Ye["[object Array]"]=Ye["[object ArrayBuffer]"]=Ye["[object Boolean]"]=Ye["[object DataView]"]=Ye["[object Date]"]=Ye["[object Error]"]=Ye["[object Function]"]=Ye["[object Map]"]=Ye["[object Number]"]=Ye["[object Object]"]=Ye["[object RegExp]"]=Ye["[object Set]"]=Ye["[object String]"]=Ye["[object WeakMap]"]=!1;var He=function(t){return O(t)&&We(t.length)&&!!Ye[_(t)]};var Ke=function(t){return function(e){return t(e)}},Qe=u((function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r&&s.process,a=function(){try{var t=n&&n.require&&n.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=a})),Ze=Qe&&Qe.isTypedArray,tr=Ze?Ke(Ze):He,er=Object.prototype.hasOwnProperty;var rr=function(t,e){var r=l(t),n=!r&&Ge(t),o=!r&&!n&&Ve(t),a=!r&&!n&&!o&&tr(t),i=r||n||o||a,u=i?Be(t.length,String):[],c=u.length;for(var f in t)!e&&!er.call(t,f)||i&&("length"==f||o&&("offset"==f||"parent"==f)||a&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||Je(f,c))||u.push(f);return u},nr=Object.prototype;var or=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||nr)},ar=Kt(Object.keys,Object),ir=Object.prototype.hasOwnProperty;var ur=function(t){if(!or(t))return ar(t);var e=[];for(var r in Object(t))ir.call(t,r)&&"constructor"!=r&&e.push(r);return e};var cr=function(t){return null!=t&&We(t.length)&&!T(t)};var fr=function(t){return cr(t)?rr(t):ur(t)};var lr=function(t){return Te(t,fr,Ue)},sr=Object.prototype.hasOwnProperty;var vr=function(t,e,r,n,o,a){var i=1&r,u=lr(t),c=u.length;if(c!=lr(e).length&&!i)return!1;for(var f=c;f--;){var l=u[f];if(!(i?l in e:sr.call(e,l)))return!1}var s=a.get(t),v=a.get(e);if(s&&v)return s==e&&v==t;var p=!0;a.set(t,e),a.set(e,t);for(var h=i;++f<c;){var d=t[l=u[f]],y=e[l];if(n)var b=i?n(y,d,l,e,t,a):n(d,y,l,t,e,a);if(!(void 0===b?d===y||o(d,y,r,n,a):b)){p=!1;break}h||(h="constructor"==l)}if(p&&!h){var g=t.constructor,m=e.constructor;g==m||!("constructor"in t)||!("constructor"in e)||"function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m||(p=!1)}return a.delete(t),a.delete(e),p},pr=V(p,"DataView"),hr=V(p,"Promise"),dr=V(p,"Set"),yr=V(p,"WeakMap"),br="[object Map]",gr="[object Promise]",mr="[object Set]",wr="[object WeakMap]",jr="[object DataView]",xr=U(pr),_r=U(vt),Or=U(hr),kr=U(dr),Sr=U(yr),Lr=_;(pr&&Lr(new pr(new ArrayBuffer(1)))!=jr||vt&&Lr(new vt)!=br||hr&&Lr(hr.resolve())!=gr||dr&&Lr(new dr)!=mr||yr&&Lr(new yr)!=wr)&&(Lr=function(t){var e=_(t),r="[object Object]"==e?t.constructor:void 0,n=r?U(r):"";if(n)switch(n){case xr:return jr;case _r:return br;case Or:return gr;case kr:return mr;case Sr:return wr}return e});var Ar=Lr,Er="[object Arguments]",Pr="[object Array]",Tr="[object Object]",Nr=Object.prototype.hasOwnProperty;var Fr=function(t,e,r,n,o,a){var i=l(t),u=l(e),c=i?Pr:Ar(t),f=u?Pr:Ar(e),s=(c=c==Er?Tr:c)==Tr,v=(f=f==Er?Tr:f)==Tr,p=c==f;if(p&&Ve(t)){if(!Ve(e))return!1;i=!0,s=!1}if(p&&!s)return a||(a=new ye),i||tr(t)?_e(t,e,r,n,o,a):Ee(t,e,c,r,n,o,a);if(!(1&r)){var h=s&&Nr.call(t,"__wrapped__"),d=v&&Nr.call(e,"__wrapped__");if(h||d){var y=h?t.value():t,b=d?e.value():e;return a||(a=new ye),o(y,b,r,n,a)}}return!!p&&(a||(a=new ye),vr(t,e,r,n,o,a))};var Ir=function t(e,r,n,o,a){return e===r||(null==e||null==r||!O(e)&&!O(r)?e!=e&&r!=r:Fr(e,r,n,o,t,a))};var zr=function(t,e){return Ir(t,e)};function Ur(t,e){function r(t){return Mt(t)?t:[t]}if(Wt(t))return!1;if(0===(t=r(t)).length)return!1;if(Wt(t))return!1;if(0===(e=r(e)).length)return!1;for(var n=0;n<t.length;n++)for(var o=0;o<e.length;o++)if(zr(t[n],e[o]))return!0;return!1}var Br=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t};var Cr=function(t){return function(e,r,n){for(var o=-1,a=Object(e),i=n(e),u=i.length;u--;){var c=i[t?u:++o];if(!1===r(a[c],c,a))break}return e}}();var Rr=function(t,e){return function(r,n){if(null==r)return r;if(!cr(r))return t(r,n);for(var o=r.length,a=e?o:-1,i=Object(r);(e?a--:++a<o)&&!1!==n(i[a],a,i););return r}}((function(t,e){return t&&Cr(t,e,fr)}));var Dr=function(t){return t};var $r=function(t){return"function"==typeof t?t:Dr};var Mr=function(t,e){return(l(t)?Br:Rr)(t,$r(e))};var Gr=function(t,e,r,n){var o=r.length,a=o,i=!n;if(null==t)return!a;for(t=Object(t);o--;){var u=r[o];if(i&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++o<a;){var c=(u=r[o])[0],f=t[c],l=u[1];if(i&&u[2]){if(void 0===f&&!(c in t))return!1}else{var s=new ye;if(n)var v=n(f,l,c,t,e,s);if(!(void 0===v?Ir(l,f,3,n,s):v))return!1}}return!0};var qr=function(t){return t==t&&!E(t)};var Vr=function(t){for(var e=fr(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,qr(o)]}return e};var Xr=function(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}};var Jr=function(t){var e=Vr(t);return 1==e.length&&e[0][2]?Xr(e[0][0],e[0][1]):function(r){return r===t||Gr(r,t,e)}};var Wr=function(t,e){return null!=t&&e in Object(t)};var Yr=function(t,e,r){for(var n=-1,o=(e=Nt(e,t)).length,a=!1;++n<o;){var i=Ft(e[n]);if(!(a=null!=t&&r(t,i)))break;t=t[i]}return a||++n!=o?a:!!(o=null==t?0:t.length)&&We(o)&&Je(i,o)&&(l(t)||Ge(t))};var Hr=function(t,e){return null!=t&&Yr(t,e,Wr)};var Kr=function(t,e){return A(t)&&qr(e)?Xr(Ft(t),e):function(r){var n=zt(r,t);return void 0===n&&n===e?Hr(r,t):Ir(e,n,3)}};var Qr=function(t){return function(e){return null==e?void 0:e[t]}};var Zr=function(t){return function(e){return It(e,t)}};var tn=function(t){return A(t)?Qr(Ft(t)):Zr(t)};var en=function(t){return"function"==typeof t?t:null==t?Dr:"object"==a(t)?l(t)?Kr(t[0],t[1]):Jr(t):tn(t)};var rn=function(t,e){var r=-1,n=cr(t)?Array(t.length):[];return Rr(t,(function(t,o,a){n[++r]=e(t,o,a)})),n};var nn=function(t,e){return(l(t)?Lt:rn)(t,en(e))},on=Array.prototype.join;var an=function(t,e){return null==t?"":on.call(t,e)};var un=function(t,e,r){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(r=r>o?o:r)<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var a=Array(o);++n<o;)a[n]=t[n+e];return a},cn=/\s/;var fn=function(t){for(var e=t.length;e--&&cn.test(t.charAt(e)););return e},ln=/^\s+/;var sn=function(t){return t?t.slice(0,fn(t)+1).replace(ln,""):t},vn=/^[-+]0x[0-9a-f]+$/i,pn=/^0b[01]+$/i,hn=/^0o[0-7]+$/i,dn=parseInt;var yn=function(t){if("number"==typeof t)return t;if(k(t))return NaN;if(E(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=E(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=sn(t);var r=pn.test(t);return r||hn.test(t)?dn(t.slice(2),r?2:8):vn.test(t)?NaN:+t},bn=1/0;var gn=function(t){return t?(t=yn(t))===bn||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var mn=function(t){var e=gn(t),r=e%1;return e==e?r?e-r:e:0};var wn=function(t,e,r){var n=null==t?0:t.length;return n?(e=r||void 0===e?1:mn(e),un(t,e<0?0:e,n)):[]};var jn=function(t){return"number"==typeof t&&t==mn(t)};function xn(t){return Dt(t)?gn(t):0}var _n=p.isFinite,On=Math.min;var kn=function(t){var e=Math[t];return function(t,r){if(t=yn(t),(r=null==r?0:On(mn(r),292))&&_n(t)){var n=(Tt(t)+"e").split("e"),o=e(n[0]+"e"+(+n[1]+r));return+((n=(Tt(o)+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round");function Sn(t){if(!function(t){return!!Dt(t)&&(t=xn(t),jn(t))}(t))return!1;var e=function(t){if(!Dt(t))return 0;t=xn(t);var e=kn(t);return"0"===String(e)?0:e}(t)>0;return e}function Ln(t){return An.apply(this,arguments)}function An(){return An=o(f.mark((function t(e){var r,n,a,i,u,c,l,s=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=s.length>1&&void 0!==s[1]?s[1]:{},null,n=Bt(),Gt(e)){t.next=6;break}return n.reject("waitfunction需輸入函數f"),t.abrupt("return",n);case 6:return a=function(){var t=o(f.mark((function t(){var r;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!ue(r=e())){t.next=5;break}return t.next=4,r;case 4:r=t.sent;case 5:return t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.next=9,a();case 9:if(!0!==t.sent){t.next=13;break}return n.resolve(),t.abrupt("return",n);case 13:return Sn(i=zt(r,"attemptNum",null))||(i=200),Sn(u=zt(r,"timeInterval",null))||(u=1e3),c=0,l=setInterval(o(f.mark((function t(){return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c+=1,t.next=3,a();case 3:!0===t.sent&&(clearInterval(l),n.resolve()),c>i&&(clearInterval(l),n.resolve());case 6:case"end":return t.stop()}}),t)}))),u),t.abrupt("return",n);case 20:case"end":return t.stop()}}),t)}))),An.apply(this,arguments)}function En(t,e){if(!Rt(t))return"";if(!Sn(e))return"";var r=t.length-e;return r<0&&(r=0),t.substr(r,e)}var Pn={},Tn={};function Nn(t){var e=t.tagName,r=t.path,n=t.attributes,o=void 0===n?{}:n,a=t.func,i=Bt();if("done"===Pn[r])return i.resolve("loaded"),i;if("loading"===Pn[r])return Ln((function(){return"done"===Pn[r]})).then((function(){i.resolve("loaded")})),i;Pn[r]="loading";var u=document.createElement(e);return Mr(o,(function(t,e){u.setAttribute(e,t)})),o.rel&&"stylesheet"===o.rel?(u.setAttribute("href",r),setTimeout((function(){i.resolve(u),Pn[r]="done"}),1)):(u.src=r,u.addEventListener("load",(function(){var t;Gt(a)?t=Ln(a):(t=Bt()).resolve(),t.then((function(){return $t(500)})).then((function(){i.resolve(u),Pn[r]="done"}))})),u.addEventListener("error",(function(){i.reject(u),Pn[r]="done"}))),document.getElementsByTagName("head")[0].appendChild(u),i}function Fn(t){var e=Bt();Mt(t)||(t=[t]),Mr(t,(function(e,r){Ct(e)&&(t[r]={path:e})}));var r=an(nn(t,"path"),"|");return"done"===Tn[r]?(e.resolve("loaded"),e):"loading"===Tn[r]?(Ln((function(){return"done"===Tn[r]})).then((function(){e.resolve("loaded")})),e):(Tn[r]="loading",Mr(t,(function(t,e){t.type||(".js"===En(t.path,3)?t.type="js":".css"===En(t.path,4)?t.type="css":t.type="unknow")})),function(t,e){var r=Bt();if(!Mt(t)&&!Jt(t))return r.reject("rs is not array or object"),r;var n=!1;if(Jt(t)){n=!0;var o=[];Mr(t,(function(t,e){o.push({k:e,v:t})})),t=o}Gt(e)||(e=function(t){return t});var a=-1,i=[];return t.reduce((function(t,r){return t.then((function(t){i.push(t);var o=a+=1,u=r;return n&&(o=r.k,u=r.v),Gt(e)?e(u,o):u}))}),Promise.resolve()).then((function(t){i.push(t),i=wn(i),r.resolve(i)})).catch((function(t){r.reject(t)})),r}(t,(function(t){var e=Bt();if("js"===t.type)e=Nn({tagName:"script",path:t.path,attributes:{type:"text/javascript"},func:t.func});else if("css"===t.type)e=Nn({tagName:"link",path:t.path,attributes:{rel:"stylesheet"}});else{var r="invalid pathItem.type: "+t.type;console.log(r),e.reject(r)}return e})).finally((function(){Tn[r]="done"})))}function In(t){function e(t){t.parentNode.removeChild(t)}if(ie(t))e(t);else if(Rt(t)){var r=function(t){return document.querySelectorAll(t)}(t);Mr(r,(function(t){e(t)}))}}function zn(t,e){if(!ie(t))return"invalid eleParent";if(Ct(e))t.insertAdjacentHTML("afterbegin",e);else{if(!ie(e))return"invalid itemChild";t.insertBefore(e,t.firstChild)}}function Un(){return"undefined"!=typeof window&&void 0!==window.document}function Bn(){return"undefined"!=typeof self?self:Un()?window:"undefined"!=typeof global?global:null}function Cn(){return Bn().htmlToImage}function Rn(t){return Dn.apply(this,arguments)}function Dn(){return Dn=o(f.mark((function t(e){var r,n,o,a,i,u,c,l,s,v,p=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=p.length>1&&void 0!==p[1]?p[1]:{},ie(e)){t.next=3;break}return t.abrupt("return",Promise.reject("invalid ele"));case 3:if(n=zt(r,"scale",1),Ut(n)){t.next=6;break}return t.abrupt("return",Promise.reject("opt.scale is not number"));case 6:if(!(n<1)){t.next=8;break}return t.abrupt("return",Promise.reject("opt.scale can not less then 1"));case 8:if("image/jpeg"===(o=zt(r,"picType","image/png"))||"image/png"===o){t.next=11;break}return t.abrupt("return",Promise.reject("opt.picType is not image/jpeg or image/png"));case 11:if(a=zt(r,"toBase64",!0),qt(a)){t.next=14;break}return t.abrupt("return",Promise.reject("opt.toBase64 is not boolean"));case 14:if(i=e.cloneNode(!0),(u=document.createElement("div")).style.position="absolute",u.style.top=0,u.style.left=0,u.style.zIndex=-1,u.appendChild(i),(c=document.createElement("div")).style.opacity=0,c.style.position="relative",c.appendChild(u),zn(document.querySelector("body"),c),l=Cn(),v={pixelRatio:n,quality:.95},!a){t.next=42;break}if("image/jpeg"!==o){t.next=36;break}return t.next=33,l.toJpeg(u,v);case 33:s=t.sent,t.next=40;break;case 36:if("image/png"!==o){t.next=40;break}return t.next=39,l.toPng(u,v);case 39:s=t.sent;case 40:t.next=45;break;case 42:return t.next=44,l.toCanvas(u,v);case 44:s=t.sent;case 45:return In(c),t.abrupt("return",s);case 47:case"end":return t.stop()}}),t)}))),Dn.apply(this,arguments)}function $n(t){return Mn.apply(this,arguments)}function Mn(){return Mn=o(f.mark((function t(e){var r,n,o,a=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:{},Yt(n=a.length>2?a[2]:void 0)||(n=["https://cdn.jsdelivr.net/npm/html-to-image@1.9.0/dist/html-to-image.js"]),t.next=5,Fn(n);case 5:return o=Rn(e,r),t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)}))),Mn.apply(this,arguments)}var Gn=h?h.isConcatSpreadable:void 0;var qn=function(t){return l(t)||Ge(t)||!!(Gn&&t&&t[Gn])};var Vn=function t(e,r,n,o,a){var i=-1,u=e.length;for(n||(n=qn),a||(a=[]);++i<u;){var c=e[i];r>0&&n(c)?r>1?t(c,r-1,n,o,a):Pe(a,c):o||(a[a.length]=c)}return a};var Xn=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e};var Jn=function(){var t=arguments.length;if(!t)return[];for(var e=Array(t-1),r=arguments[0],n=t;n--;)e[n-1]=arguments[n];return Pe(l(r)?Xn(r):[r],Vn(e,1))};function Wn(t){if(Jt(t)){for(var e in t)return!0;return!1}return!1}function Yn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Hn(t){return function(t){if(Array.isArray(t))return Yn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Yn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Yn(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Kn=function(t,e,r,n){for(var o=t.length,a=r+(n?1:-1);n?a--:++a<o;)if(e(t[a],a,t))return a;return-1};var Qn=function(t){return t!=t};var Zn=function(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1};var to=function(t,e,r){return e==e?Zn(t,e,r):Kn(t,Qn,r)};var eo=function(t,e){return!!(null==t?0:t.length)&&to(t,e,0)>-1};var ro=function(t,e,r){for(var n=-1,o=null==t?0:t.length;++n<o;)if(r(e,t[n]))return!0;return!1};var no=function(){},oo=dr&&1/Se(new dr([,-0]))[1]==1/0?function(t){return new dr(t)}:no;var ao=function(t,e,r){var n=-1,o=eo,a=t.length,i=!0,u=[],c=u;if(r)i=!1,o=ro;else if(a>=200){var f=e?null:oo(t);if(f)return Se(f);i=!1,o=xe,c=new we}else c=e?[]:u;t:for(;++n<a;){var l=t[n],s=e?e(l):l;if(l=r||0!==l?l:0,i&&s==s){for(var v=c.length;v--;)if(c[v]===s)continue t;e&&c.push(s),u.push(l)}else o(c,s,r)||(c!==u&&c.push(s),u.push(l))}return u};var io=function(t){return t&&t.length?ao(t):[]};function uo(t){if(!Yt(t))return[];var e=[];return Mr(t,(function(t){var r=fr(t);e=[].concat(Hn(e),Hn(r)),e=io(e)})),e}var co=function(t){return"string"==typeof t||!l(t)&&O(t)&&"[object String]"==_(t)},fo=Qr("length"),lo=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var so=function(t){return lo.test(t)},vo="[\\ud800-\\udfff]",po="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ho="\\ud83c[\\udffb-\\udfff]",yo="[^\\ud800-\\udfff]",bo="(?:\\ud83c[\\udde6-\\uddff]){2}",go="[\\ud800-\\udbff][\\udc00-\\udfff]",mo="(?:"+po+"|"+ho+")"+"?",wo="[\\ufe0e\\ufe0f]?",jo=wo+mo+("(?:\\u200d(?:"+[yo,bo,go].join("|")+")"+wo+mo+")*"),xo="(?:"+[yo+po+"?",po,bo,go,vo].join("|")+")",_o=RegExp(ho+"(?="+ho+")|"+xo+jo,"g");var Oo=function(t){for(var e=_o.lastIndex=0;_o.test(t);)++e;return e};var ko=function(t){return so(t)?Oo(t):fo(t)};var So=function(t){if(null==t)return 0;if(cr(t))return co(t)?ko(t):t.length;var e=Ar(t);return"[object Map]"==e||"[object Set]"==e?t.size:ur(t).length};function Lo(t,e){if(!Yt(t))return[];if(Yt(e)||(e=uo(t)),0===So(e))return[];var r=!1;if(Mr(t,(function(t){Wn(t)||(r=!0)})),r)return[];var n=[];return Mr(t,(function(t){var r=nn(e,(function(e){return Vt(t[e])?t[e]?"true":"false":Ct(t[e])||Dt(t[e])?t[e]:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Xt(t))return"";var r="";try{r=e?JSON.stringify(t,null,2):JSON.stringify(t)}catch(t){r=""}return r}(t[e])}));n.push(r)})),n}function Ao(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!Yt(t))return[];Yt(e)||(e=uo(t)),Wn(r)||(r={},Mr(e,(function(t){r[t]=t})));var n=!1;if(Mr(t,(function(t){Wn(t)||(n=!0)})),n)return[];var o=nn(e,(function(t){return zt(r,t)})),a=Lo(t,e),i=Jn([o],a);return i}function Eo(t,e){if(Un())if(Rt(t)){var r=document.createElement("a");r.href=e,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)}else console.log("no filename");else console.log("no window")}function Po(t,e){Un()?Rt(t)?null!==navigator.userAgent.toLowerCase().match(/rv:([\d.]+)\) like gecko/)?function(t,e){window.navigator.msSaveOrOpenBlob(e,t)}(t,e):function(t,e){var r=window.URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(r)}(t,e):console.log("no filename"):console.log("no window")}function To(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";function r(){if(!(this instanceof r))return new r;this.SheetNames=[],this.Sheets={}}var n=new r;return n.SheetNames.push(e),n.Sheets[e]=t,n}function No(){var t=Bn();return r.default||t.XLSX||t.xlsx}function Fo(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";if(!Mt(t)&&!ie(t))return{error:"data is not array or element"};Rt(e)||(e="data");var r=null;try{var n=No(),o=n.utils,a=null;Mt(t)?a=o.aoa_to_sheet(t):ie(t)&&(a=o.table_to_sheet(t,{raw:!0})),r=To(a,e)}catch(t){return{error:t}}return r}function Io(){var t=Bn();return r.default||t.XLSX||t.xlsx}function zo(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data",r=arguments.length>2?arguments[2]:void 0;if(!Rt(t)){var n="no filename";return console.log(n,t),{error:n}}if(Rt(e)||(e="data"),!Mt(r)&&!ie(r)){var o="data is not array or element";return console.log(o,r),{error:o}}Mt(r)&&Wn(zt(r,0,null))&&(r=Ao(r));var a=Fo(r,e);if(zt(a,"error"))return console.log(a.error),a.error;var i=Io();if(Un()){var u=i.write(a,{bookType:"xlsx",bookSST:!1,type:"array"});Po(t,new Blob([u]))}else i.writeFile(a,t);return"ok"}function Uo(t){return Bo.apply(this,arguments)}function Bo(){return Bo=o(f.mark((function t(e){var r,n,o,a,i=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:"data",n=i.length>2?i[2]:void 0,Yt(o=i.length>3?i[3]:void 0)||(o=["https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"]),t.next=6,Fn(o);case 6:if(a=zo(e,r,n),""===zt(a,"error","")){t.next=9;break}return t.abrupt("return",Promise.reject(a.error));case 9:return t.abrupt("return",a);case 10:case"end":return t.stop()}}),t)}))),Bo.apply(this,arguments)}function Co(t,e){if(Un())if(Rt(t))if(Ht(e)){var r=function(t){return Ht(t)?new Blob([t]):new Blob}(e);Po(t,r)}else console.log("no data");else console.log("no filename");else console.log("no window")}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=zt(e,"keyFunDownloadFileById");Rt(r)||(r="downloadFileById");var n=zt(e,"keyFunUpdateLoading");Rt(n)||(n="updateLoading");var a=zt(e,"keyFunAlert");Rt(a)||(a="alert");var i=zt(e,"useBrowserView");Vt(i)||(i=!0);var u=zt(e,"browserViewTypes");Yt(u)||(u=["text/plain","application/rtf","application/json","text/csv","text/html","text/xml","application/xml","application/pdf","image/png","image/jpg","image/jpeg","image/gif","image/bmp","image/svg+xml","image/webp","audio/mpeg","video/mpeg","video/mp4","video/webm"]);var c=zt(e,"textErrorDownloadImage");Rt(c)||(c="無法下載圖片");var l=zt(e,"textErrorDownloadTable");Rt(l)||(l="無法下載表格數據");var s=zt(e,"textErrorDownloadLtdt");Rt(s)||(s="無法下載數據");var v=zt(e,"textInvalidElePic");Rt(v)||(v="elePic非元素");var p=zt(e,"textInvalidEleName");Rt(p)||(p="eleName非元素或字串");var h=zt(e,"textInvalidEleTable");Rt(h)||(h="eleTable非元素");var d=zt(e,"textInvalidLtdt");Rt(d)||(d="ltdt非陣列");var y=zt(e,"textInvalidFileId");Rt(y)||(y="無檔案主鍵");var b=zt(e,"textInvalidKeyFilename");Rt(b)||(b="無檔案名稱主鍵");var g=zt(e,"textInvalidFilename");Rt(g)||(g="無檔案名稱");var m=zt(e,"textInvalidFileU8a");Rt(m)||(m="無檔案內容");var w=zt(e,"textInvalidFileType");Rt(w)||(w="無檔案類型");var j=zt(e,"textDownloadingFile");Rt(j)||(j="開始下載檔案");var x=zt(e,"textDownloadFileSuccessfully");Rt(x)||(x="下載檔案成功");var _=zt(e,"textDownloadFileFailed");function O(){var e=zt(t,r);if(Gt(e))return e.apply(void 0,arguments)}function k(){var e=zt(t,n);if(Gt(e))return e.apply(void 0,arguments)}function S(){var e=zt(t,a);if(Gt(e))return e.apply(void 0,arguments)}function L(t,e){return A.apply(this,arguments)}function A(){return A=o(f.mark((function t(e,r){var n,a,i,u,l,s,h,d,y=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(d=function(){return d=o(f.mark((function t(e,r){var n,o,i,c;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(ie(e)){t.next=2;break}return t.abrupt("return",Promise.reject(v));case 2:if(ie(r)||Rt(r)){t.next=4;break}return t.abrupt("return",Promise.reject(p));case 4:return n="",Rt(n=ie(r)?zt(r,"innerText"):r)||(n=u),o="".concat(n,".png"),"#fff"!==(i=e.style.background)&&(e.style.background="#fff"),t.next=12,$n(e,{scale:a});case 12:c=t.sent,e.style.background=i,Eo(o,c);case 15:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)},h=function(t,e){return d.apply(this,arguments)},n=y.length>2&&void 0!==y[2]?y[2]:{},a=zt(n,"scale"),Ut(a)||(a=3),i=zt(n,"timeDelay"),Ut(i)||(i=500),Rt(u=zt(n,"defName"))||(u="pic"),Vt(l=zt(n,"useAlert"))||(l=!0),Vt(s=zt(n,"useUpdateLoading"))||(s=!0),!s){t.next=17;break}return k(!0),t.next=17,$t(i);case 17:return t.next=19,h(e,r).catch((function(t){console.log(t),l&&S(c,{type:"error"})})).finally((function(){s&&k(!1)}));case 19:case"end":return t.stop()}}),t)}))),A.apply(this,arguments)}function E(t,e){return P.apply(this,arguments)}function P(){return P=o(f.mark((function t(e,r){var n,a,i,u,c,s,v,d,y=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(d=function(){return d=o(f.mark((function t(e,r){var n,o;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(ie(e)){t.next=2;break}return t.abrupt("return",Promise.reject(h));case 2:if(ie(r)||Rt(r)){t.next=4;break}return t.abrupt("return",Promise.reject(p));case 4:return n="",Rt(n=ie(r)?zt(r,"innerText"):r)||(n=u),o="".concat(n,".xlsx"),t.next=10,Uo(o,a,e);case 10:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)},v=function(t,e){return d.apply(this,arguments)},n=y.length>2&&void 0!==y[2]?y[2]:{},Rt(a=zt(n,"nameSheet"))||(a="data"),i=zt(n,"timeDelay"),Ut(i)||(i=500),Rt(u=zt(n,"defName"))||(u="table"),Vt(c=zt(n,"useAlert"))||(c=!0),Vt(s=zt(n,"useUpdateLoading"))||(s=!0),!s){t.next=17;break}return k(!0),t.next=17,$t(i);case 17:return t.next=19,v(e,r).catch((function(t){console.log(t),c&&S(l,{type:"error"})})).finally((function(){s&&k(!1)}));case 19:case"end":return t.stop()}}),t)}))),P.apply(this,arguments)}function T(t,e){return N.apply(this,arguments)}function N(){return N=o(f.mark((function t(e,r){var n,a,i,u,c,l,v,h,y=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(h=function(){return h=o(f.mark((function t(e,r){var n,o,i;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Mt(e)){t.next=2;break}return t.abrupt("return",Promise.reject(d));case 2:if(ie(r)||Rt(r)){t.next=4;break}return t.abrupt("return",Promise.reject(p));case 4:return n="",Rt(n=ie(r)?zt(r,"innerText"):r)||(n=u),o="".concat(n,".xlsx"),i=Ao(e),t.next=11,Uo(o,a,i);case 11:case"end":return t.stop()}}),t)}))),h.apply(this,arguments)},v=function(t,e){return h.apply(this,arguments)},n=y.length>2&&void 0!==y[2]?y[2]:{},Rt(a=zt(n,"nameSheet"))||(a="data"),i=zt(n,"timeDelay"),Ut(i)||(i=500),Rt(u=zt(n,"defName"))||(u="table"),Vt(c=zt(n,"useAlert"))||(c=!0),Vt(l=zt(n,"useUpdateLoading"))||(l=!0),!l){t.next=17;break}return k(!0),t.next=17,$t(i);case 17:return t.next=19,v(e,r).catch((function(t){console.log(t),c&&S(s,{type:"error"})})).finally((function(){l&&k(!1)}));case 19:case"end":return t.stop()}}),t)}))),N.apply(this,arguments)}function F(t){return I.apply(this,arguments)}function I(){return I=o(f.mark((function t(e){var r,n,a,c,l,s,v,p,h=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(p=function(){return(p=o(f.mark((function t(){var n,o,c,l,s;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Gt(r)&&r(0),Rt(n=zt(e,"id"))){t.next=5;break}return console.log(y,e),t.abrupt("return",Promise.reject(y));case 5:if(!ue(o=O(n,(function(t){var e=t.prog;t.p,"download"===t.m&&Gt(r)&&r(e)})))){t.next=10;break}return t.next=9,o;case 9:o=t.sent;case 10:if(ce(o,a)){t.next=13;break}return console.log(b,o),t.abrupt("return",Promise.reject(b));case 13:if(Rt(c=zt(o,a,""))){t.next=17;break}return console.log(g,o),t.abrupt("return",Promise.reject(g));case 17:if(Ht(l=zt(o,"u8a"))){t.next=21;break}return console.log(m,o),t.abrupt("return",Promise.reject(m));case 21:if(Co(c,l),!i){t.next=28;break}if(Rt(s=zt(o,"type"))){t.next=27;break}return console.log(w,o),t.abrupt("return",Promise.reject(w));case 27:Ur(s,u)&&fe(l,s);case 28:case"end":return t.stop()}}),t)})))).apply(this,arguments)},v=function(){return p.apply(this,arguments)},r=h.length>1&&void 0!==h[1]?h[1]:null,n=h.length>2&&void 0!==h[2]?h[2]:{},Rt(a=zt(n,"keyFileName"))||(a="fileName"),c=zt(n,"timeDelay"),Ut(c)||(c=500),Vt(l=zt(n,"useAlert"))||(l=!0),Vt(s=zt(n,"useUpdateLoading"))||(s=!1),l&&S("".concat(j,": ").concat(e.fileName),{type:"infor"}),!s){t.next=17;break}return k(!0),t.next=17,$t(c);case 17:return t.next=19,v().then((function(){l&&S("".concat(x,": ").concat(e.name))})).catch((function(t){console.log(t),l&&S("".concat(_,": ").concat(e.name),{type:"error"})})).finally((function(){Gt(r)&&r(null),s&&k(!1)}));case 19:case"end":return t.stop()}}),t)}))),I.apply(this,arguments)}return Rt(_)||(_="下載檔案失敗"),{downloadPic:L,downloadTable:E,downloadLtdt:T,downloadFile:F}}}));
//# sourceMappingURL=w-ui-dwload.umd.js.map
