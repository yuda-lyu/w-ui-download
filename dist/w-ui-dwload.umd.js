/*!
 * w-ui-dwload v1.0.2
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("xlsx")):"function"==typeof define&&define.amd?define(["xlsx"],r):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-ui-dwload"]=r(t.XLSX)}(this,(function(t){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e=r(t);function n(t,r,e,n,o,a,i){try{var u=t[a](i),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function o(t){return function(){var r=this,e=arguments;return new Promise((function(o,a){var i=t.apply(r,e);function u(t){n(i,o,a,u,c,"next",t)}function c(t){n(i,o,a,u,c,"throw",t)}u(void 0)}))}}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function u(t){var r={exports:{}};return t(r,r.exports),r.exports}var c=u((function(t){var r=function(t){var r,e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function f(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{f({},"")}catch(t){f=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var o=r&&r.prototype instanceof b?r:b,a=Object.create(o.prototype),i=new E(n||[]);return a._invoke=function(t,r,e){var n=v;return function(o,a){if(n===h)throw new Error("Generator is already running");if(n===d){if("throw"===o)throw a;return T()}for(e.method=o,e.arg=a;;){var i=e.delegate;if(i){var u=S(i,e);if(u){if(u===y)continue;return u}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(n===v)throw n=d,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n=h;var c=s(t,r,e);if("normal"===c.type){if(n=e.done?d:p,c.arg===y)continue;return{value:c.arg,done:e.done}}"throw"===c.type&&(n=d,e.method="throw",e.arg=c.arg)}}}(t,e,i),a}function s(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var v="suspendedStart",p="suspendedYield",h="executing",d="completed",y={};function b(){}function g(){}function m(){}var w={};f(w,i,(function(){return this}));var j=Object.getPrototypeOf,x=j&&j(j(P([])));x&&x!==e&&n.call(x,i)&&(w=x);var _=m.prototype=b.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(r){f(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,u,c){var f=s(t[o],t,i);if("throw"!==f.type){var l=f.arg,v=l.value;return v&&"object"===a(v)&&n.call(v,"__await")?r.resolve(v.__await).then((function(t){e("next",t,u,c)}),(function(t){e("throw",t,u,c)})):r.resolve(v).then((function(t){l.value=t,u(l)}),(function(t){return e("throw",t,u,c)}))}c(f.arg)}var o;this._invoke=function(t,n){function a(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(a,a):a()}}function S(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,S(t,e),"throw"===e.method))return y;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,y;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,y):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function A(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(n.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=r,e.done=!0,e};return a.next=a}}return{next:T}}function T(){return{value:r,done:!0}}return g.prototype=m,f(_,"constructor",m),f(m,"constructor",g),g.displayName=f(m,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===g||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,f(t,c,"GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},O(k.prototype),f(k.prototype,u,(function(){return this})),t.AsyncIterator=k,t.async=function(r,e,n,o,a){void 0===a&&(a=Promise);var i=new k(l(r,e,n,o),a);return t.isGeneratorFunction(e)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},O(_),f(_,c,"Generator"),f(_,i,(function(){return this})),f(_,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=[];for(var e in t)r.push(e);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(n,o){return u.type="throw",u.arg=t,e.next=n,o&&(e.method="next",e.arg=r),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],u=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),f=n.call(i,"finallyLoc");if(c&&f){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=r,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),y},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),A(e),y}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;A(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:P(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),y}},t}(t.exports);try{regeneratorRuntime=r}catch(t){"object"===("undefined"==typeof globalThis?"undefined":a(globalThis))?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}})),f=c,l=Array.isArray,s="object"==a(i)&&i&&i.Object===Object&&i,v="object"==("undefined"==typeof self?"undefined":a(self))&&self&&self.Object===Object&&self,p=s||v||Function("return this")(),h=p.Symbol,d=Object.prototype,y=d.hasOwnProperty,b=d.toString,g=h?h.toStringTag:void 0;var m=function(t){var r=y.call(t,g),e=t[g];try{t[g]=void 0;var n=!0}catch(t){}var o=b.call(t);return n&&(r?t[g]=e:delete t[g]),o},w=Object.prototype.toString;var j=function(t){return w.call(t)},x=h?h.toStringTag:void 0;var _=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":x&&x in Object(t)?m(t):j(t)};var O=function(t){return null!=t&&"object"==a(t)};var k=function(t){return"symbol"==a(t)||O(t)&&"[object Symbol]"==_(t)},S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,L=/^\w*$/;var A=function(t,r){if(l(t))return!1;var e=a(t);return!("number"!=e&&"symbol"!=e&&"boolean"!=e&&null!=t&&!k(t))||(L.test(t)||!S.test(t)||null!=r&&t in Object(r))};var E=function(t){var r=a(t);return null!=t&&("object"==r||"function"==r)};var P,T=function(t){if(!E(t))return!1;var r=_(t);return"[object Function]"==r||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r},N=p["__core-js_shared__"],I=(P=/[^.]+$/.exec(N&&N.keys&&N.keys.IE_PROTO||""))?"Symbol(src)_1."+P:"";var F=function(t){return!!I&&I in t},z=Function.prototype.toString;var U=function(t){if(null!=t){try{return z.call(t)}catch(t){}try{return t+""}catch(t){}}return""},B=/^\[object .+?Constructor\]$/,C=Function.prototype,R=Object.prototype,D=C.toString,$=R.hasOwnProperty,M=RegExp("^"+D.call($).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var G=function(t){return!(!E(t)||F(t))&&(T(t)?M:B).test(U(t))};var q=function(t,r){return null==t?void 0:t[r]};var V=function(t,r){var e=q(t,r);return G(e)?e:void 0},X=V(Object,"create");var J=function(){this.__data__=X?X(null):{},this.size=0};var W=function(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r},Y=Object.prototype.hasOwnProperty;var H=function(t){var r=this.__data__;if(X){var e=r[t];return"__lodash_hash_undefined__"===e?void 0:e}return Y.call(r,t)?r[t]:void 0},K=Object.prototype.hasOwnProperty;var Q=function(t){var r=this.__data__;return X?void 0!==r[t]:K.call(r,t)};var Z=function(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=X&&void 0===r?"__lodash_hash_undefined__":r,this};function tt(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}tt.prototype.clear=J,tt.prototype.delete=W,tt.prototype.get=H,tt.prototype.has=Q,tt.prototype.set=Z;var rt=tt;var et=function(){this.__data__=[],this.size=0};var nt=function(t,r){return t===r||t!=t&&r!=r};var ot=function(t,r){for(var e=t.length;e--;)if(nt(t[e][0],r))return e;return-1},at=Array.prototype.splice;var it=function(t){var r=this.__data__,e=ot(r,t);return!(e<0)&&(e==r.length-1?r.pop():at.call(r,e,1),--this.size,!0)};var ut=function(t){var r=this.__data__,e=ot(r,t);return e<0?void 0:r[e][1]};var ct=function(t){return ot(this.__data__,t)>-1};var ft=function(t,r){var e=this.__data__,n=ot(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this};function lt(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}lt.prototype.clear=et,lt.prototype.delete=it,lt.prototype.get=ut,lt.prototype.has=ct,lt.prototype.set=ft;var st=lt,vt=V(p,"Map");var pt=function(){this.size=0,this.__data__={hash:new rt,map:new(vt||st),string:new rt}};var ht=function(t){var r=a(t);return"string"==r||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t};var dt=function(t,r){var e=t.__data__;return ht(r)?e["string"==typeof r?"string":"hash"]:e.map};var yt=function(t){var r=dt(this,t).delete(t);return this.size-=r?1:0,r};var bt=function(t){return dt(this,t).get(t)};var gt=function(t){return dt(this,t).has(t)};var mt=function(t,r){var e=dt(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this};function wt(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}wt.prototype.clear=pt,wt.prototype.delete=yt,wt.prototype.get=bt,wt.prototype.has=gt,wt.prototype.set=mt;var jt=wt;function xt(t,r){if("function"!=typeof t||null!=r&&"function"!=typeof r)throw new TypeError("Expected a function");var e=function e(){var n=arguments,o=r?r.apply(this,n):n[0],a=e.cache;if(a.has(o))return a.get(o);var i=t.apply(this,n);return e.cache=a.set(o,i)||a,i};return e.cache=new(xt.Cache||jt),e}xt.Cache=jt;var _t=xt;var Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,kt=/\\(\\)?/g,St=function(t){var r=_t(t,(function(t){return 500===e.size&&e.clear(),t})),e=r.cache;return r}((function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(Ot,(function(t,e,n,o){r.push(n?o.replace(kt,"$1"):e||t)})),r}));var Lt=function(t,r){for(var e=-1,n=null==t?0:t.length,o=Array(n);++e<n;)o[e]=r(t[e],e,t);return o},At=h?h.prototype:void 0,Et=At?At.toString:void 0;var Pt=function t(r){if("string"==typeof r)return r;if(l(r))return Lt(r,t)+"";if(k(r))return Et?Et.call(r):"";var e=r+"";return"0"==e&&1/r==-Infinity?"-0":e};var Tt=function(t){return null==t?"":Pt(t)};var Nt=function(t,r){return l(t)?t:A(t,r)?[t]:St(Tt(t))};var It=function(t){if("string"==typeof t||k(t))return t;var r=t+"";return"0"==r&&1/t==-Infinity?"-0":r};var Ft=function(t,r){for(var e=0,n=(r=Nt(r,t)).length;null!=t&&e<n;)t=t[It(r[e++])];return e&&e==n?t:void 0};var zt=function(t,r,e){var n=null==t?void 0:Ft(t,r);return void 0===n?e:n};var Ut=function(t){return"number"==typeof t||O(t)&&"[object Number]"==_(t)};function Bt(){var t,r,e=new Promise((function(){t=arguments[0],r=arguments[1]}));return e.resolve=t,e.reject=r,e}function Ct(t){return"[object String]"===Object.prototype.toString.call(t)}function Rt(t){return!(!Ct(t)||""===t)}function Dt(t){var r=!1;return Rt(t)?r=!isNaN(Number(t)):function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)&&(r=!0),r}function $t(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;Dt(t)||(t=10);var r=Bt();return setTimeout((function(){r.resolve()}),t),r}function Mt(t){return"[object Array]"===Object.prototype.toString.call(t)}function Gt(t){var r=Object.prototype.toString.call(t);return"[object Function]"===r||"[object AsyncFunction]"===r}var qt=function(t){return!0===t||!1===t||O(t)&&"[object Boolean]"==_(t)};function Vt(t){return qt(t)}function Xt(t){return"[object Undefined]"===Object.prototype.toString.call(t)}function Jt(t){return"[object Object]"===Object.prototype.toString.call(t)}function Wt(t){return!!Xt(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(Jt(t)){for(var r in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!Ct(t)||""!==t)}(t)||!!function(t){return!!Mt(t)&&0===t.length}(t))))}function Yt(t){return!!Mt(t)&&(0!==t.length&&(1!==t.length||!Wt(t[0])))}function Ht(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)}var Kt=function(t,r){return function(e){return t(r(e))}},Qt=Kt(Object.getPrototypeOf,Object),Zt=Function.prototype,tr=Object.prototype,rr=Zt.toString,er=tr.hasOwnProperty,nr=rr.call(Object);var or=function(t){if(!O(t)||"[object Object]"!=_(t))return!1;var r=Qt(t);if(null===r)return!0;var e=er.call(r,"constructor")&&r.constructor;return"function"==typeof e&&e instanceof e&&rr.call(e)==nr};var ar=function(t){return O(t)&&1===t.nodeType&&!or(t)};function ir(t){return ar(t)}function ur(t){var r,e=Object.prototype.toString.call(t);if(r="[object Promise]"===e)return!0;if("[object Function]"!==e)return!1;try{r="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return r}function cr(t,r){var e=new Blob([t],{type:r});try{var n=window.URL.createObjectURL(e);window.open(n)}catch(t){console.log("window.URL.createObjectURL is not support for IE11",t)}}var fr=function(){this.__data__=new st,this.size=0};var lr=function(t){var r=this.__data__,e=r.delete(t);return this.size=r.size,e};var sr=function(t){return this.__data__.get(t)};var vr=function(t){return this.__data__.has(t)};var pr=function(t,r){var e=this.__data__;if(e instanceof st){var n=e.__data__;if(!vt||n.length<199)return n.push([t,r]),this.size=++e.size,this;e=this.__data__=new jt(n)}return e.set(t,r),this.size=e.size,this};function hr(t){var r=this.__data__=new st(t);this.size=r.size}hr.prototype.clear=fr,hr.prototype.delete=lr,hr.prototype.get=sr,hr.prototype.has=vr,hr.prototype.set=pr;var dr=hr;var yr=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};var br=function(t){return this.__data__.has(t)};function gr(t){var r=-1,e=null==t?0:t.length;for(this.__data__=new jt;++r<e;)this.add(t[r])}gr.prototype.add=gr.prototype.push=yr,gr.prototype.has=br;var mr=gr;var wr=function(t,r){for(var e=-1,n=null==t?0:t.length;++e<n;)if(r(t[e],e,t))return!0;return!1};var jr=function(t,r){return t.has(r)};var xr=function(t,r,e,n,o,a){var i=1&e,u=t.length,c=r.length;if(u!=c&&!(i&&c>u))return!1;var f=a.get(t),l=a.get(r);if(f&&l)return f==r&&l==t;var s=-1,v=!0,p=2&e?new mr:void 0;for(a.set(t,r),a.set(r,t);++s<u;){var h=t[s],d=r[s];if(n)var y=i?n(d,h,s,r,t,a):n(h,d,s,t,r,a);if(void 0!==y){if(y)continue;v=!1;break}if(p){if(!wr(r,(function(t,r){if(!jr(p,r)&&(h===t||o(h,t,e,n,a)))return p.push(r)}))){v=!1;break}}else if(h!==d&&!o(h,d,e,n,a)){v=!1;break}}return a.delete(t),a.delete(r),v},_r=p.Uint8Array;var Or=function(t){var r=-1,e=Array(t.size);return t.forEach((function(t,n){e[++r]=[n,t]})),e};var kr=function(t){var r=-1,e=Array(t.size);return t.forEach((function(t){e[++r]=t})),e},Sr=h?h.prototype:void 0,Lr=Sr?Sr.valueOf:void 0;var Ar=function(t,r,e,n,o,a,i){switch(e){case"[object DataView]":if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=r.byteLength||!a(new _r(t),new _r(r)));case"[object Boolean]":case"[object Date]":case"[object Number]":return nt(+t,+r);case"[object Error]":return t.name==r.name&&t.message==r.message;case"[object RegExp]":case"[object String]":return t==r+"";case"[object Map]":var u=Or;case"[object Set]":var c=1&n;if(u||(u=kr),t.size!=r.size&&!c)return!1;var f=i.get(t);if(f)return f==r;n|=2,i.set(t,r);var l=xr(u(t),u(r),n,o,a,i);return i.delete(t),l;case"[object Symbol]":if(Lr)return Lr.call(t)==Lr.call(r)}return!1};var Er=function(t,r){for(var e=-1,n=r.length,o=t.length;++e<n;)t[o+e]=r[e];return t};var Pr=function(t,r,e){var n=r(t);return l(t)?n:Er(n,e(t))};var Tr=function(t,r){for(var e=-1,n=null==t?0:t.length,o=0,a=[];++e<n;){var i=t[e];r(i,e,t)&&(a[o++]=i)}return a};var Nr=function(){return[]},Ir=Object.prototype.propertyIsEnumerable,Fr=Object.getOwnPropertySymbols,zr=Fr?function(t){return null==t?[]:(t=Object(t),Tr(Fr(t),(function(r){return Ir.call(t,r)})))}:Nr;var Ur=function(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n};var Br=function(t){return O(t)&&"[object Arguments]"==_(t)},Cr=Object.prototype,Rr=Cr.hasOwnProperty,Dr=Cr.propertyIsEnumerable,$r=Br(function(){return arguments}())?Br:function(t){return O(t)&&Rr.call(t,"callee")&&!Dr.call(t,"callee")},Mr=$r;var Gr=function(){return!1},qr=u((function(t,r){var e=r&&!r.nodeType&&r,n=e&&t&&!t.nodeType&&t,o=n&&n.exports===e?p.Buffer:void 0,a=(o?o.isBuffer:void 0)||Gr;t.exports=a})),Vr=/^(?:0|[1-9]\d*)$/;var Xr=function(t,r){var e=a(t);return!!(r=null==r?9007199254740991:r)&&("number"==e||"symbol"!=e&&Vr.test(t))&&t>-1&&t%1==0&&t<r};var Jr=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},Wr={};Wr["[object Float32Array]"]=Wr["[object Float64Array]"]=Wr["[object Int8Array]"]=Wr["[object Int16Array]"]=Wr["[object Int32Array]"]=Wr["[object Uint8Array]"]=Wr["[object Uint8ClampedArray]"]=Wr["[object Uint16Array]"]=Wr["[object Uint32Array]"]=!0,Wr["[object Arguments]"]=Wr["[object Array]"]=Wr["[object ArrayBuffer]"]=Wr["[object Boolean]"]=Wr["[object DataView]"]=Wr["[object Date]"]=Wr["[object Error]"]=Wr["[object Function]"]=Wr["[object Map]"]=Wr["[object Number]"]=Wr["[object Object]"]=Wr["[object RegExp]"]=Wr["[object Set]"]=Wr["[object String]"]=Wr["[object WeakMap]"]=!1;var Yr=function(t){return O(t)&&Jr(t.length)&&!!Wr[_(t)]};var Hr=function(t){return function(r){return t(r)}},Kr=u((function(t,r){var e=r&&!r.nodeType&&r,n=e&&t&&!t.nodeType&&t,o=n&&n.exports===e&&s.process,a=function(){try{var t=n&&n.require&&n.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=a})),Qr=Kr&&Kr.isTypedArray,Zr=Qr?Hr(Qr):Yr,te=Object.prototype.hasOwnProperty;var re=function(t,r){var e=l(t),n=!e&&Mr(t),o=!e&&!n&&qr(t),a=!e&&!n&&!o&&Zr(t),i=e||n||o||a,u=i?Ur(t.length,String):[],c=u.length;for(var f in t)!r&&!te.call(t,f)||i&&("length"==f||o&&("offset"==f||"parent"==f)||a&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||Xr(f,c))||u.push(f);return u},ee=Object.prototype;var ne=function(t){var r=t&&t.constructor;return t===("function"==typeof r&&r.prototype||ee)},oe=Kt(Object.keys,Object),ae=Object.prototype.hasOwnProperty;var ie=function(t){if(!ne(t))return oe(t);var r=[];for(var e in Object(t))ae.call(t,e)&&"constructor"!=e&&r.push(e);return r};var ue=function(t){return null!=t&&Jr(t.length)&&!T(t)};var ce=function(t){return ue(t)?re(t):ie(t)};var fe=function(t){return Pr(t,ce,zr)},le=Object.prototype.hasOwnProperty;var se=function(t,r,e,n,o,a){var i=1&e,u=fe(t),c=u.length;if(c!=fe(r).length&&!i)return!1;for(var f=c;f--;){var l=u[f];if(!(i?l in r:le.call(r,l)))return!1}var s=a.get(t),v=a.get(r);if(s&&v)return s==r&&v==t;var p=!0;a.set(t,r),a.set(r,t);for(var h=i;++f<c;){var d=t[l=u[f]],y=r[l];if(n)var b=i?n(y,d,l,r,t,a):n(d,y,l,t,r,a);if(!(void 0===b?d===y||o(d,y,e,n,a):b)){p=!1;break}h||(h="constructor"==l)}if(p&&!h){var g=t.constructor,m=r.constructor;g==m||!("constructor"in t)||!("constructor"in r)||"function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m||(p=!1)}return a.delete(t),a.delete(r),p},ve=V(p,"DataView"),pe=V(p,"Promise"),he=V(p,"Set"),de=V(p,"WeakMap"),ye="[object Map]",be="[object Promise]",ge="[object Set]",me="[object WeakMap]",we="[object DataView]",je=U(ve),xe=U(vt),_e=U(pe),Oe=U(he),ke=U(de),Se=_;(ve&&Se(new ve(new ArrayBuffer(1)))!=we||vt&&Se(new vt)!=ye||pe&&Se(pe.resolve())!=be||he&&Se(new he)!=ge||de&&Se(new de)!=me)&&(Se=function(t){var r=_(t),e="[object Object]"==r?t.constructor:void 0,n=e?U(e):"";if(n)switch(n){case je:return we;case xe:return ye;case _e:return be;case Oe:return ge;case ke:return me}return r});var Le=Se,Ae="[object Arguments]",Ee="[object Array]",Pe="[object Object]",Te=Object.prototype.hasOwnProperty;var Ne=function(t,r,e,n,o,a){var i=l(t),u=l(r),c=i?Ee:Le(t),f=u?Ee:Le(r),s=(c=c==Ae?Pe:c)==Pe,v=(f=f==Ae?Pe:f)==Pe,p=c==f;if(p&&qr(t)){if(!qr(r))return!1;i=!0,s=!1}if(p&&!s)return a||(a=new dr),i||Zr(t)?xr(t,r,e,n,o,a):Ar(t,r,c,e,n,o,a);if(!(1&e)){var h=s&&Te.call(t,"__wrapped__"),d=v&&Te.call(r,"__wrapped__");if(h||d){var y=h?t.value():t,b=d?r.value():r;return a||(a=new dr),o(y,b,e,n,a)}}return!!p&&(a||(a=new dr),se(t,r,e,n,o,a))};var Ie=function t(r,e,n,o,a){return r===e||(null==r||null==e||!O(r)&&!O(e)?r!=r&&e!=e:Ne(r,e,n,o,t,a))};var Fe=function(t,r){return Ie(t,r)};function ze(t,r){function e(t){return Mt(t)?t:[t]}if(Wt(t))return!1;if(0===(t=e(t)).length)return!1;if(Wt(t))return!1;if(0===(r=e(r)).length)return!1;for(var n=0;n<t.length;n++)for(var o=0;o<r.length;o++)if(Fe(t[n],r[o]))return!0;return!1}var Ue=function(t,r){for(var e=-1,n=null==t?0:t.length;++e<n&&!1!==r(t[e],e,t););return t};var Be=function(t){return function(r,e,n){for(var o=-1,a=Object(r),i=n(r),u=i.length;u--;){var c=i[t?u:++o];if(!1===e(a[c],c,a))break}return r}}();var Ce=function(t,r){return function(e,n){if(null==e)return e;if(!ue(e))return t(e,n);for(var o=e.length,a=r?o:-1,i=Object(e);(r?a--:++a<o)&&!1!==n(i[a],a,i););return e}}((function(t,r){return t&&Be(t,r,ce)}));var Re=function(t){return t};var De=function(t){return"function"==typeof t?t:Re};var $e=function(t,r){return(l(t)?Ue:Ce)(t,De(r))};var Me=function(t,r,e,n){var o=e.length,a=o,i=!n;if(null==t)return!a;for(t=Object(t);o--;){var u=e[o];if(i&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++o<a;){var c=(u=e[o])[0],f=t[c],l=u[1];if(i&&u[2]){if(void 0===f&&!(c in t))return!1}else{var s=new dr;if(n)var v=n(f,l,c,t,r,s);if(!(void 0===v?Ie(l,f,3,n,s):v))return!1}}return!0};var Ge=function(t){return t==t&&!E(t)};var qe=function(t){for(var r=ce(t),e=r.length;e--;){var n=r[e],o=t[n];r[e]=[n,o,Ge(o)]}return r};var Ve=function(t,r){return function(e){return null!=e&&(e[t]===r&&(void 0!==r||t in Object(e)))}};var Xe=function(t){var r=qe(t);return 1==r.length&&r[0][2]?Ve(r[0][0],r[0][1]):function(e){return e===t||Me(e,t,r)}};var Je=function(t,r){return null!=t&&r in Object(t)};var We=function(t,r,e){for(var n=-1,o=(r=Nt(r,t)).length,a=!1;++n<o;){var i=It(r[n]);if(!(a=null!=t&&e(t,i)))break;t=t[i]}return a||++n!=o?a:!!(o=null==t?0:t.length)&&Jr(o)&&Xr(i,o)&&(l(t)||Mr(t))};var Ye=function(t,r){return null!=t&&We(t,r,Je)};var He=function(t,r){return A(t)&&Ge(r)?Ve(It(t),r):function(e){var n=zt(e,t);return void 0===n&&n===r?Ye(e,t):Ie(r,n,3)}};var Ke=function(t){return function(r){return null==r?void 0:r[t]}};var Qe=function(t){return function(r){return Ft(r,t)}};var Ze=function(t){return A(t)?Ke(It(t)):Qe(t)};var tn=function(t){return"function"==typeof t?t:null==t?Re:"object"==a(t)?l(t)?He(t[0],t[1]):Xe(t):Ze(t)};var rn=function(t,r){var e=-1,n=ue(t)?Array(t.length):[];return Ce(t,(function(t,o,a){n[++e]=r(t,o,a)})),n};var en=function(t,r){return(l(t)?Lt:rn)(t,tn(r))},nn=Array.prototype.join;var on=function(t,r){return null==t?"":nn.call(t,r)};var an=function(t,r,e){var n=-1,o=t.length;r<0&&(r=-r>o?0:o+r),(e=e>o?o:e)<0&&(e+=o),o=r>e?0:e-r>>>0,r>>>=0;for(var a=Array(o);++n<o;)a[n]=t[n+r];return a},un=/\s/;var cn=function(t){for(var r=t.length;r--&&un.test(t.charAt(r)););return r},fn=/^\s+/;var ln=function(t){return t?t.slice(0,cn(t)+1).replace(fn,""):t},sn=/^[-+]0x[0-9a-f]+$/i,vn=/^0b[01]+$/i,pn=/^0o[0-7]+$/i,hn=parseInt;var dn=function(t){if("number"==typeof t)return t;if(k(t))return NaN;if(E(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=E(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=ln(t);var e=vn.test(t);return e||pn.test(t)?hn(t.slice(2),e?2:8):sn.test(t)?NaN:+t},yn=1/0;var bn=function(t){return t?(t=dn(t))===yn||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var gn=function(t){var r=bn(t),e=r%1;return r==r?e?r-e:r:0};var mn=function(t,r,e){var n=null==t?0:t.length;return n?(r=e||void 0===r?1:gn(r),an(t,r<0?0:r,n)):[]};var wn=function(t){return"number"==typeof t&&t==gn(t)};function jn(t){return Dt(t)?bn(t):0}var xn=p.isFinite,_n=Math.min;var On=function(t){var r=Math[t];return function(t,e){if(t=dn(t),(e=null==e?0:_n(gn(e),292))&&xn(t)){var n=(Tt(t)+"e").split("e"),o=r(n[0]+"e"+(+n[1]+e));return+((n=(Tt(o)+"e").split("e"))[0]+"e"+(+n[1]-e))}return r(t)}}("round");function kn(t){if(!function(t){return!!Dt(t)&&(t=jn(t),wn(t))}(t))return!1;var r=function(t){if(!Dt(t))return 0;t=jn(t);var r=On(t);return"0"===String(r)?0:r}(t)>0;return r}function Sn(t){return Ln.apply(this,arguments)}function Ln(){return Ln=o(f.mark((function t(r){var e,n,a,i,u,c,l,s=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=s.length>1&&void 0!==s[1]?s[1]:{},null,n=Bt(),Gt(r)){t.next=6;break}return n.reject("waitfunction需輸入函數f"),t.abrupt("return",n);case 6:return a=function(){var t=o(f.mark((function t(){var e;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!ur(e=r())){t.next=5;break}return t.next=4,e;case 4:e=t.sent;case 5:return t.abrupt("return",e);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.next=9,a();case 9:if(!0!==t.sent){t.next=13;break}return n.resolve(),t.abrupt("return",n);case 13:return kn(i=zt(e,"attemptNum",null))||(i=200),kn(u=zt(e,"timeInterval",null))||(u=1e3),c=0,l=setInterval(o(f.mark((function t(){return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c+=1,t.next=3,a();case 3:!0===t.sent&&(clearInterval(l),n.resolve()),c>i&&(clearInterval(l),n.resolve());case 6:case"end":return t.stop()}}),t)}))),u),t.abrupt("return",n);case 20:case"end":return t.stop()}}),t)}))),Ln.apply(this,arguments)}function An(t,r){if(!Rt(t))return"";if(!kn(r))return"";var e=t.length-r;return e<0&&(e=0),t.substr(e,r)}var En={},Pn={};function Tn(t){var r=t.tagName,e=t.path,n=t.attributes,o=void 0===n?{}:n,a=t.func,i=Bt();if("done"===En[e])return i.resolve("loaded"),i;if("loading"===En[e])return Sn((function(){return"done"===En[e]})).then((function(){i.resolve("loaded")})),i;En[e]="loading";var u=document.createElement(r);return $e(o,(function(t,r){u.setAttribute(r,t)})),o.rel&&"stylesheet"===o.rel?(u.setAttribute("href",e),setTimeout((function(){i.resolve(u),En[e]="done"}),1)):(u.src=e,u.addEventListener("load",(function(){var t;Gt(a)?t=Sn(a):(t=Bt()).resolve(),t.then((function(){return $t(500)})).then((function(){i.resolve(u),En[e]="done"}))})),u.addEventListener("error",(function(){i.reject(u),En[e]="done"}))),document.getElementsByTagName("head")[0].appendChild(u),i}function Nn(t){var r=Bt();Mt(t)||(t=[t]),$e(t,(function(r,e){Ct(r)&&(t[e]={path:r})}));var e=on(en(t,"path"),"|");return"done"===Pn[e]?(r.resolve("loaded"),r):"loading"===Pn[e]?(Sn((function(){return"done"===Pn[e]})).then((function(){r.resolve("loaded")})),r):(Pn[e]="loading",$e(t,(function(t,r){t.type||(".js"===An(t.path,3)?t.type="js":".css"===An(t.path,4)?t.type="css":t.type="unknow")})),function(t,r){var e=Bt();if(!Mt(t)&&!Jt(t))return e.reject("rs is not array or object"),e;var n=!1;if(Jt(t)){n=!0;var o=[];$e(t,(function(t,r){o.push({k:r,v:t})})),t=o}Gt(r)||(r=function(t){return t});var a=-1,i=[];return t.reduce((function(t,e){return t.then((function(t){i.push(t);var o=a+=1,u=e;return n&&(o=e.k,u=e.v),Gt(r)?r(u,o):u}))}),Promise.resolve()).then((function(t){i.push(t),i=mn(i),e.resolve(i)})).catch((function(t){e.reject(t)})),e}(t,(function(t){var r=Bt();if("js"===t.type)r=Tn({tagName:"script",path:t.path,attributes:{type:"text/javascript"},func:t.func});else if("css"===t.type)r=Tn({tagName:"link",path:t.path,attributes:{rel:"stylesheet"}});else{var e="invalid pathItem.type: "+t.type;console.log(e),r.reject(e)}return r})).finally((function(){Pn[e]="done"})))}function In(t){function r(t){t.parentNode.removeChild(t)}if(ir(t))r(t);else if(Rt(t)){var e=function(t){return document.querySelectorAll(t)}(t);$e(e,(function(t){r(t)}))}}function Fn(t,r){if(!ir(t))return"invalid eleParent";if(Ct(r))t.insertAdjacentHTML("afterbegin",r);else{if(!ir(r))return"invalid itemChild";t.insertBefore(r,t.firstChild)}}function zn(){return"undefined"!=typeof window&&void 0!==window.document}function Un(){return"undefined"!=typeof self?self:zn()?window:"undefined"!=typeof global?global:null}function Bn(){return Un().htmlToImage}function Cn(t){return Rn.apply(this,arguments)}function Rn(){return Rn=o(f.mark((function t(r){var e,n,o,a,i,u,c,l,s,v,p=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=p.length>1&&void 0!==p[1]?p[1]:{},ir(r)){t.next=3;break}return t.abrupt("return",Promise.reject("invalid ele"));case 3:if(n=zt(e,"scale",1),Ut(n)){t.next=6;break}return t.abrupt("return",Promise.reject("opt.scale is not number"));case 6:if(!(n<1)){t.next=8;break}return t.abrupt("return",Promise.reject("opt.scale can not less then 1"));case 8:if("image/jpeg"===(o=zt(e,"picType","image/png"))||"image/png"===o){t.next=11;break}return t.abrupt("return",Promise.reject("opt.picType is not image/jpeg or image/png"));case 11:if(a=zt(e,"toBase64",!0),qt(a)){t.next=14;break}return t.abrupt("return",Promise.reject("opt.toBase64 is not boolean"));case 14:if(i=r.cloneNode(!0),(u=document.createElement("div")).style.position="absolute",u.style.top=0,u.style.left=0,u.style.zIndex=-1,u.appendChild(i),(c=document.createElement("div")).style.opacity=0,c.style.position="relative",c.appendChild(u),Fn(document.querySelector("body"),c),l=Bn(),v={pixelRatio:n,quality:.95},!a){t.next=42;break}if("image/jpeg"!==o){t.next=36;break}return t.next=33,l.toJpeg(u,v);case 33:s=t.sent,t.next=40;break;case 36:if("image/png"!==o){t.next=40;break}return t.next=39,l.toPng(u,v);case 39:s=t.sent;case 40:t.next=45;break;case 42:return t.next=44,l.toCanvas(u,v);case 44:s=t.sent;case 45:return In(c),t.abrupt("return",s);case 47:case"end":return t.stop()}}),t)}))),Rn.apply(this,arguments)}function Dn(t){return $n.apply(this,arguments)}function $n(){return $n=o(f.mark((function t(r){var e,n,o,a=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.length>1&&void 0!==a[1]?a[1]:{},Yt(n=a.length>2?a[2]:void 0)||(n=["https://cdn.jsdelivr.net/npm/html-to-image@1.9.0/dist/html-to-image.js"]),t.next=5,Nn(n);case 5:return o=Cn(r,e),t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)}))),$n.apply(this,arguments)}var Mn=h?h.isConcatSpreadable:void 0;var Gn=function(t){return l(t)||Mr(t)||!!(Mn&&t&&t[Mn])};var qn=function t(r,e,n,o,a){var i=-1,u=r.length;for(n||(n=Gn),a||(a=[]);++i<u;){var c=r[i];e>0&&n(c)?e>1?t(c,e-1,n,o,a):Er(a,c):o||(a[a.length]=c)}return a};var Vn=function(t,r){var e=-1,n=t.length;for(r||(r=Array(n));++e<n;)r[e]=t[e];return r};var Xn=function(){var t=arguments.length;if(!t)return[];for(var r=Array(t-1),e=arguments[0],n=t;n--;)r[n-1]=arguments[n];return Er(l(e)?Vn(e):[e],qn(r,1))};function Jn(t){if(Jt(t)){for(var r in t)return!0;return!1}return!1}function Wn(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Yn(t){return function(t){if(Array.isArray(t))return Wn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(t){if("string"==typeof t)return Wn(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Wn(t,r):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Hn=function(t,r,e,n){for(var o=t.length,a=e+(n?1:-1);n?a--:++a<o;)if(r(t[a],a,t))return a;return-1};var Kn=function(t){return t!=t};var Qn=function(t,r,e){for(var n=e-1,o=t.length;++n<o;)if(t[n]===r)return n;return-1};var Zn=function(t,r,e){return r==r?Qn(t,r,e):Hn(t,Kn,e)};var to=function(t,r){return!!(null==t?0:t.length)&&Zn(t,r,0)>-1};var ro=function(t,r,e){for(var n=-1,o=null==t?0:t.length;++n<o;)if(e(r,t[n]))return!0;return!1};var eo=function(){},no=he&&1/kr(new he([,-0]))[1]==1/0?function(t){return new he(t)}:eo;var oo=function(t,r,e){var n=-1,o=to,a=t.length,i=!0,u=[],c=u;if(e)i=!1,o=ro;else if(a>=200){var f=r?null:no(t);if(f)return kr(f);i=!1,o=jr,c=new mr}else c=r?[]:u;t:for(;++n<a;){var l=t[n],s=r?r(l):l;if(l=e||0!==l?l:0,i&&s==s){for(var v=c.length;v--;)if(c[v]===s)continue t;r&&c.push(s),u.push(l)}else o(c,s,e)||(c!==u&&c.push(s),u.push(l))}return u};var ao=function(t){return t&&t.length?oo(t):[]};function io(t){if(!Yt(t))return[];var r=[];return $e(t,(function(t){var e=ce(t);r=[].concat(Yn(r),Yn(e)),r=ao(r)})),r}var uo=function(t){return"string"==typeof t||!l(t)&&O(t)&&"[object String]"==_(t)},co=Ke("length"),fo=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var lo=function(t){return fo.test(t)},so="[\\ud800-\\udfff]",vo="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",po="\\ud83c[\\udffb-\\udfff]",ho="[^\\ud800-\\udfff]",yo="(?:\\ud83c[\\udde6-\\uddff]){2}",bo="[\\ud800-\\udbff][\\udc00-\\udfff]",go="(?:"+vo+"|"+po+")"+"?",mo="[\\ufe0e\\ufe0f]?",wo=mo+go+("(?:\\u200d(?:"+[ho,yo,bo].join("|")+")"+mo+go+")*"),jo="(?:"+[ho+vo+"?",vo,yo,bo,so].join("|")+")",xo=RegExp(po+"(?="+po+")|"+jo+wo,"g");var _o=function(t){for(var r=xo.lastIndex=0;xo.test(t);)++r;return r};var Oo=function(t){return lo(t)?_o(t):co(t)};var ko=function(t){if(null==t)return 0;if(ue(t))return uo(t)?Oo(t):t.length;var r=Le(t);return"[object Map]"==r||"[object Set]"==r?t.size:ie(t).length};function So(t,r){if(!Yt(t))return[];if(Yt(r)||(r=io(t)),0===ko(r))return[];var e=!1;if($e(t,(function(t){Jn(t)||(e=!0)})),e)return[];var n=[];return $e(t,(function(t){var e=en(r,(function(r){return Vt(t[r])?t[r]?"true":"false":Ct(t[r])||Dt(t[r])?t[r]:function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Xt(t))return"";var e="";try{e=r?JSON.stringify(t,null,2):JSON.stringify(t)}catch(t){e=""}return e}(t[r])}));n.push(e)})),n}function Lo(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!Yt(t))return[];Yt(r)||(r=io(t)),Jn(e)||(e={},$e(r,(function(t){e[t]=t})));var n=!1;if($e(t,(function(t){Jn(t)||(n=!0)})),n)return[];var o=en(r,(function(t){return zt(e,t)})),a=So(t,r),i=Xn([o],a);return i}function Ao(t,r){if(zn())if(Rt(t)){var e=document.createElement("a");e.href=r,e.download=t,document.body.appendChild(e),e.click(),document.body.removeChild(e)}else console.log("no filename");else console.log("no window")}function Eo(t,r){zn()?Rt(t)?null!==navigator.userAgent.toLowerCase().match(/rv:([\d.]+)\) like gecko/)?function(t,r){window.navigator.msSaveOrOpenBlob(r,t)}(t,r):function(t,r){var e=window.URL.createObjectURL(r),n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(e)}(t,r):console.log("no filename"):console.log("no window")}function Po(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";function e(){if(!(this instanceof e))return new e;this.SheetNames=[],this.Sheets={}}var n=new e;return n.SheetNames.push(r),n.Sheets[r]=t,n}function To(){var t=Un();return e.default||t.XLSX||t.xlsx}function No(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";if(!Mt(t)&&!ir(t))return{error:"data is not array or element"};Rt(r)||(r="data");var e=null;try{var n=To(),o=n.utils,a=null;Mt(t)?a=o.aoa_to_sheet(t):ir(t)&&(a=o.table_to_sheet(t,{raw:!0})),e=Po(a,r)}catch(t){return{error:t}}return e}function Io(){var t=Un();return e.default||t.XLSX||t.xlsx}function Fo(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data",e=arguments.length>2?arguments[2]:void 0;if(!Rt(t)){var n="no filename";return console.log(n,t),{error:n}}if(Rt(r)||(r="data"),!Mt(e)&&!ir(e)){var o="data is not array or element";return console.log(o,e),{error:o}}Mt(e)&&Jn(zt(e,0,null))&&(e=Lo(e));var a=No(e,r);if(zt(a,"error"))return console.log(a.error),a.error;var i=Io();if(zn()){var u=i.write(a,{bookType:"xlsx",bookSST:!1,type:"array"});Eo(t,new Blob([u]))}else i.writeFile(a,t);return"ok"}function zo(t){return Uo.apply(this,arguments)}function Uo(){return Uo=o(f.mark((function t(r){var e,n,o,a,i=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.length>1&&void 0!==i[1]?i[1]:"data",n=i.length>2?i[2]:void 0,Yt(o=i.length>3?i[3]:void 0)||(o=["https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"]),t.next=6,Nn(o);case 6:if(a=Fo(r,e,n),""===zt(a,"error","")){t.next=9;break}return t.abrupt("return",Promise.reject(a.error));case 9:return t.abrupt("return",a);case 10:case"end":return t.stop()}}),t)}))),Uo.apply(this,arguments)}function Bo(t,r){if(zn())if(Rt(t))if(Ht(r)){var e=function(t){return Ht(t)?new Blob([t]):new Blob}(r);Eo(t,e)}else console.log("no data");else console.log("no filename");else console.log("no window")}return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=zt(r,"keyFunDownloadFileById");Rt(e)||(e="downloadFileById");var n=zt(r,"keyFunUpdateLoading");Rt(n)||(n="updateLoading");var a=zt(r,"keyFunAlert");Rt(a)||(a="alert");var i=zt(r,"useBrowserView");Vt(i)||(i=!0);var u=zt(r,"browserViewTypes");Yt(u)||(u=["text/plain","application/rtf","application/json","text/csv","text/html","text/xml","application/xml","application/pdf","image/png","image/jpg","image/jpeg","image/gif","image/bmp","image/svg+xml","image/webp","audio/mpeg","video/mpeg","video/mp4","video/webm"]);var c=zt(r,"textErrorDownloadImage");Rt(c)||(c="無法下載圖片");var l=zt(r,"textErrorDownloadTable");Rt(l)||(l="無法下載表格數據");var s=zt(r,"textErrorDownloadLtdt");Rt(s)||(s="無法下載數據");var v=zt(r,"textInvalidElePic");Rt(v)||(v="elePic非元素");var p=zt(r,"textInvalidEleName");Rt(p)||(p="eleName非元素或字串");var h=zt(r,"textInvalidEleTable");Rt(h)||(h="eleTable非元素");var d=zt(r,"textInvalidLtdt");Rt(d)||(d="ltdt非陣列");var y=zt(r,"textInvalidFileId");Rt(y)||(y="無檔案主鍵");var b=zt(r,"textInvalidFilename");Rt(b)||(b="無檔案名稱");var g=zt(r,"textInvalidFileU8a");Rt(g)||(g="無檔案內容");var m=zt(r,"textInvalidFileType");Rt(m)||(m="無檔案類型");var w=zt(r,"textDownloadingFile");Rt(w)||(w="開始下載檔案");var j=zt(r,"textDownloadFileSuccessfully");Rt(j)||(j="下載檔案成功");var x=zt(r,"textDownloadFileFailed");function _(){var r=zt(t,e);if(Gt(r))return r.apply(void 0,arguments)}function O(){var r=zt(t,n);if(Gt(r))return r.apply(void 0,arguments)}function k(){var r=zt(t,a);if(Gt(r))return r.apply(void 0,arguments)}function S(t,r){return L.apply(this,arguments)}function L(){return L=o(f.mark((function t(r,e){var n,a,i,u,l,s,h,d,y=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(d=function(){return d=o(f.mark((function t(r,e){var n,o,i,c;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(ir(r)){t.next=2;break}return t.abrupt("return",Promise.reject(v));case 2:if(ir(e)||Rt(e)){t.next=4;break}return t.abrupt("return",Promise.reject(p));case 4:return n="",Rt(n=ir(e)?zt(e,"innerText"):e)||(n=u),o="".concat(n,".png"),"#fff"!==(i=r.style.background)&&(r.style.background="#fff"),t.next=12,Dn(r,{scale:a});case 12:c=t.sent,r.style.background=i,Ao(o,c);case 15:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)},h=function(t,r){return d.apply(this,arguments)},n=y.length>2&&void 0!==y[2]?y[2]:{},a=zt(n,"scale"),Ut(a)||(a=3),i=zt(n,"timeDelay"),Ut(i)||(i=500),Rt(u=zt(n,"defName"))||(u="pic"),Vt(l=zt(n,"useAlert"))||(l=!0),Vt(s=zt(n,"useUpdateLoading"))||(s=!0),!s){t.next=17;break}return O(!0),t.next=17,$t(i);case 17:return t.next=19,h(r,e).catch((function(t){console.log(t),l&&k(c,{type:"error"})})).finally((function(){s&&O(!1)}));case 19:case"end":return t.stop()}}),t)}))),L.apply(this,arguments)}function A(t,r){return E.apply(this,arguments)}function E(){return E=o(f.mark((function t(r,e){var n,a,i,u,c,s,v,d,y=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(d=function(){return d=o(f.mark((function t(r,e){var n,o;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(ir(r)){t.next=2;break}return t.abrupt("return",Promise.reject(h));case 2:if(ir(e)||Rt(e)){t.next=4;break}return t.abrupt("return",Promise.reject(p));case 4:return n="",Rt(n=ir(e)?zt(e,"innerText"):e)||(n=u),o="".concat(n,".xlsx"),t.next=10,zo(o,a,r);case 10:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)},v=function(t,r){return d.apply(this,arguments)},n=y.length>2&&void 0!==y[2]?y[2]:{},Rt(a=zt(n,"nameSheet"))||(a="data"),i=zt(n,"timeDelay"),Ut(i)||(i=500),Rt(u=zt(n,"defName"))||(u="table"),Vt(c=zt(n,"useAlert"))||(c=!0),Vt(s=zt(n,"useUpdateLoading"))||(s=!0),!s){t.next=17;break}return O(!0),t.next=17,$t(i);case 17:return t.next=19,v(r,e).catch((function(t){console.log(t),c&&k(l,{type:"error"})})).finally((function(){s&&O(!1)}));case 19:case"end":return t.stop()}}),t)}))),E.apply(this,arguments)}function P(t,r){return T.apply(this,arguments)}function T(){return T=o(f.mark((function t(r,e){var n,a,i,u,c,l,v,h,y=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(h=function(){return h=o(f.mark((function t(r,e){var n,o,i;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Mt(r)){t.next=2;break}return t.abrupt("return",Promise.reject(d));case 2:if(ir(e)||Rt(e)){t.next=4;break}return t.abrupt("return",Promise.reject(p));case 4:return n="",Rt(n=ir(e)?zt(e,"innerText"):e)||(n=u),o="".concat(n,".xlsx"),i=Lo(r),t.next=11,zo(o,a,i);case 11:case"end":return t.stop()}}),t)}))),h.apply(this,arguments)},v=function(t,r){return h.apply(this,arguments)},n=y.length>2&&void 0!==y[2]?y[2]:{},Rt(a=zt(n,"nameSheet"))||(a="data"),i=zt(n,"timeDelay"),Ut(i)||(i=500),Rt(u=zt(n,"defName"))||(u="table"),Vt(c=zt(n,"useAlert"))||(c=!0),Vt(l=zt(n,"useUpdateLoading"))||(l=!0),!l){t.next=17;break}return O(!0),t.next=17,$t(i);case 17:return t.next=19,v(r,e).catch((function(t){console.log(t),c&&k(s,{type:"error"})})).finally((function(){l&&O(!1)}));case 19:case"end":return t.stop()}}),t)}))),T.apply(this,arguments)}function N(t){return I.apply(this,arguments)}function I(){return I=o(f.mark((function t(r){var e,n,a,c,l,s,v,p=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(v=function(){return(v=o(f.mark((function t(){var n,o,a,c,l;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Gt(e)&&e(0),Rt(n=zt(r,"id"))){t.next=5;break}return console.log(y,r),t.abrupt("return",Promise.reject(y));case 5:if(!ur(o=_(n,(function(t){var r=t.prog;t.p,"download"===t.m&&Gt(e)&&e(r)})))){t.next=10;break}return t.next=9,o;case 9:o=t.sent;case 10:if(Rt(a=zt(o,"fileName"))){t.next=14;break}return console.log(b,o),t.abrupt("return",Promise.reject(b));case 14:if(Ht(c=zt(o,"u8a"))){t.next=18;break}return console.log(g,o),t.abrupt("return",Promise.reject(g));case 18:if(Bo(a,c),!i){t.next=25;break}if(Rt(l=zt(o,"type"))){t.next=24;break}return console.log(m,o),t.abrupt("return",Promise.reject(m));case 24:ze(l,u)&&cr(c,l);case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)},s=function(){return v.apply(this,arguments)},e=p.length>1&&void 0!==p[1]?p[1]:null,n=p.length>2&&void 0!==p[2]?p[2]:{},a=zt(n,"timeDelay"),Ut(a)||(a=500),Vt(c=zt(n,"useAlert"))||(c=!0),Vt(l=zt(n,"useUpdateLoading"))||(l=!1),c&&k("".concat(w,": ").concat(r.fileName),{type:"infor"}),!l){t.next=15;break}return O(!0),t.next=15,$t(a);case 15:return t.next=17,s().then((function(){c&&k("".concat(j,": ").concat(r.name))})).catch((function(t){console.log(t),c&&k("".concat(x,": ").concat(r.name),{type:"error"})})).finally((function(){Gt(e)&&e(null),l&&O(!1)}));case 17:case"end":return t.stop()}}),t)}))),I.apply(this,arguments)}return Rt(x)||(x="下載檔案失敗"),{downloadPic:S,downloadTable:A,downloadLtdt:P,downloadFile:N}}}));
//# sourceMappingURL=w-ui-dwload.umd.js.map
