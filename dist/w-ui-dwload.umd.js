/*!
 * w-ui-dwload v1.0.4
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("xlsx")):"function"==typeof define&&define.amd?define(["xlsx"],r):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-ui-dwload"]=r(t.XLSX)}(this,(function(t){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e=r(t);function n(t,r,e,n,o,a,i){try{var u=t[a](i),c=u.value}catch(t){return void e(t)}u.done?r(c):Promise.resolve(c).then(n,o)}function o(t){return function(){var r=this,e=arguments;return new Promise((function(o,a){var i=t.apply(r,e);function u(t){n(i,o,a,u,c,"next",t)}function c(t){n(i,o,a,u,c,"throw",t)}u(void 0)}))}}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function u(t){var r={exports:{}};return t(r,r.exports),r.exports}var c=u((function(t){var r=function(t){var r,e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function f(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{f({},"")}catch(t){f=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var o=r&&r.prototype instanceof b?r:b,a=Object.create(o.prototype),i=new E(n||[]);return a._invoke=function(t,r,e){var n=v;return function(o,a){if(n===h)throw new Error("Generator is already running");if(n===d){if("throw"===o)throw a;return T()}for(e.method=o,e.arg=a;;){var i=e.delegate;if(i){var u=S(i,e);if(u){if(u===y)continue;return u}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(n===v)throw n=d,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n=h;var c=s(t,r,e);if("normal"===c.type){if(n=e.done?d:p,c.arg===y)continue;return{value:c.arg,done:e.done}}"throw"===c.type&&(n=d,e.method="throw",e.arg=c.arg)}}}(t,e,i),a}function s(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var v="suspendedStart",p="suspendedYield",h="executing",d="completed",y={};function b(){}function g(){}function m(){}var w={};f(w,i,(function(){return this}));var j=Object.getPrototypeOf,x=j&&j(j(P([])));x&&x!==e&&n.call(x,i)&&(w=x);var _=m.prototype=b.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(r){f(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,u,c){var f=s(t[o],t,i);if("throw"!==f.type){var l=f.arg,v=l.value;return v&&"object"===a(v)&&n.call(v,"__await")?r.resolve(v.__await).then((function(t){e("next",t,u,c)}),(function(t){e("throw",t,u,c)})):r.resolve(v).then((function(t){l.value=t,u(l)}),(function(t){return e("throw",t,u,c)}))}c(f.arg)}var o;this._invoke=function(t,n){function a(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(a,a):a()}}function S(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,S(t,e),"throw"===e.method))return y;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,y;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,y):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function L(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function A(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(n.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=r,e.done=!0,e};return a.next=a}}return{next:T}}function T(){return{value:r,done:!0}}return g.prototype=m,f(_,"constructor",m),f(m,"constructor",g),g.displayName=f(m,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===g||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,f(t,c,"GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},O(k.prototype),f(k.prototype,u,(function(){return this})),t.AsyncIterator=k,t.async=function(r,e,n,o,a){void 0===a&&(a=Promise);var i=new k(l(r,e,n,o),a);return t.isGeneratorFunction(e)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},O(_),f(_,c,"Generator"),f(_,i,(function(){return this})),f(_,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var r=[];for(var e in t)r.push(e);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(n,o){return u.type="throw",u.arg=t,e.next=n,o&&(e.method="next",e.arg=r),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],u=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),f=n.call(i,"finallyLoc");if(c&&f){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=r,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),y},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),A(e),y}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;A(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:P(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),y}},t}(t.exports);try{regeneratorRuntime=r}catch(t){"object"===("undefined"==typeof globalThis?"undefined":a(globalThis))?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}})),f=c,l=Array.isArray,s="object"==a(i)&&i&&i.Object===Object&&i,v="object"==("undefined"==typeof self?"undefined":a(self))&&self&&self.Object===Object&&self,p=s||v||Function("return this")(),h=p.Symbol,d=Object.prototype,y=d.hasOwnProperty,b=d.toString,g=h?h.toStringTag:void 0;var m=function(t){var r=y.call(t,g),e=t[g];try{t[g]=void 0;var n=!0}catch(t){}var o=b.call(t);return n&&(r?t[g]=e:delete t[g]),o},w=Object.prototype.toString;var j=function(t){return w.call(t)},x=h?h.toStringTag:void 0;var _=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":x&&x in Object(t)?m(t):j(t)};var O=function(t){return null!=t&&"object"==a(t)};var k=function(t){return"symbol"==a(t)||O(t)&&"[object Symbol]"==_(t)},S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,L=/^\w*$/;var A=function(t,r){if(l(t))return!1;var e=a(t);return!("number"!=e&&"symbol"!=e&&"boolean"!=e&&null!=t&&!k(t))||(L.test(t)||!S.test(t)||null!=r&&t in Object(r))};var E=function(t){var r=a(t);return null!=t&&("object"==r||"function"==r)};var P,T=function(t){if(!E(t))return!1;var r=_(t);return"[object Function]"==r||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r},N=p["__core-js_shared__"],F=(P=/[^.]+$/.exec(N&&N.keys&&N.keys.IE_PROTO||""))?"Symbol(src)_1."+P:"";var I=function(t){return!!F&&F in t},z=Function.prototype.toString;var U=function(t){if(null!=t){try{return z.call(t)}catch(t){}try{return t+""}catch(t){}}return""},B=/^\[object .+?Constructor\]$/,X=Function.prototype,C=Object.prototype,R=X.toString,D=C.hasOwnProperty,$=RegExp("^"+R.call(D).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var M=function(t){return!(!E(t)||I(t))&&(T(t)?$:B).test(U(t))};var G=function(t,r){return null==t?void 0:t[r]};var q=function(t,r){var e=G(t,r);return M(e)?e:void 0},V=q(Object,"create");var J=function(){this.__data__=V?V(null):{},this.size=0};var W=function(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r},Y=Object.prototype.hasOwnProperty;var H=function(t){var r=this.__data__;if(V){var e=r[t];return"__lodash_hash_undefined__"===e?void 0:e}return Y.call(r,t)?r[t]:void 0},K=Object.prototype.hasOwnProperty;var Q=function(t){var r=this.__data__;return V?void 0!==r[t]:K.call(r,t)};var Z=function(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=V&&void 0===r?"__lodash_hash_undefined__":r,this};function tt(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}tt.prototype.clear=J,tt.prototype.delete=W,tt.prototype.get=H,tt.prototype.has=Q,tt.prototype.set=Z;var rt=tt;var et=function(){this.__data__=[],this.size=0};var nt=function(t,r){return t===r||t!=t&&r!=r};var ot=function(t,r){for(var e=t.length;e--;)if(nt(t[e][0],r))return e;return-1},at=Array.prototype.splice;var it=function(t){var r=this.__data__,e=ot(r,t);return!(e<0)&&(e==r.length-1?r.pop():at.call(r,e,1),--this.size,!0)};var ut=function(t){var r=this.__data__,e=ot(r,t);return e<0?void 0:r[e][1]};var ct=function(t){return ot(this.__data__,t)>-1};var ft=function(t,r){var e=this.__data__,n=ot(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this};function lt(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}lt.prototype.clear=et,lt.prototype.delete=it,lt.prototype.get=ut,lt.prototype.has=ct,lt.prototype.set=ft;var st=lt,vt=q(p,"Map");var pt=function(){this.size=0,this.__data__={hash:new rt,map:new(vt||st),string:new rt}};var ht=function(t){var r=a(t);return"string"==r||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t};var dt=function(t,r){var e=t.__data__;return ht(r)?e["string"==typeof r?"string":"hash"]:e.map};var yt=function(t){var r=dt(this,t).delete(t);return this.size-=r?1:0,r};var bt=function(t){return dt(this,t).get(t)};var gt=function(t){return dt(this,t).has(t)};var mt=function(t,r){var e=dt(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this};function wt(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}wt.prototype.clear=pt,wt.prototype.delete=yt,wt.prototype.get=bt,wt.prototype.has=gt,wt.prototype.set=mt;var jt=wt;function xt(t,r){if("function"!=typeof t||null!=r&&"function"!=typeof r)throw new TypeError("Expected a function");var e=function e(){var n=arguments,o=r?r.apply(this,n):n[0],a=e.cache;if(a.has(o))return a.get(o);var i=t.apply(this,n);return e.cache=a.set(o,i)||a,i};return e.cache=new(xt.Cache||jt),e}xt.Cache=jt;var _t=xt;var Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,kt=/\\(\\)?/g,St=function(t){var r=_t(t,(function(t){return 500===e.size&&e.clear(),t})),e=r.cache;return r}((function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(Ot,(function(t,e,n,o){r.push(n?o.replace(kt,"$1"):e||t)})),r}));var Lt=function(t,r){for(var e=-1,n=null==t?0:t.length,o=Array(n);++e<n;)o[e]=r(t[e],e,t);return o},At=h?h.prototype:void 0,Et=At?At.toString:void 0;var Pt=function t(r){if("string"==typeof r)return r;if(l(r))return Lt(r,t)+"";if(k(r))return Et?Et.call(r):"";var e=r+"";return"0"==e&&1/r==-Infinity?"-0":e};var Tt=function(t){return null==t?"":Pt(t)};var Nt=function(t,r){return l(t)?t:A(t,r)?[t]:St(Tt(t))};var Ft=function(t){if("string"==typeof t||k(t))return t;var r=t+"";return"0"==r&&1/t==-Infinity?"-0":r};var It=function(t,r){for(var e=0,n=(r=Nt(r,t)).length;null!=t&&e<n;)t=t[Ft(r[e++])];return e&&e==n?t:void 0};var zt=function(t,r,e){var n=null==t?void 0:It(t,r);return void 0===n?e:n};var Ut=function(t){return"number"==typeof t||O(t)&&"[object Number]"==_(t)};function Bt(){var t,r,e=new Promise((function(){t=arguments[0],r=arguments[1]}));return e.resolve=t,e.reject=r,e}function Xt(t){return"[object String]"===Object.prototype.toString.call(t)}function Ct(t){return!(!Xt(t)||""===t)}function Rt(t){var r=!1;return Ct(t)?r=!isNaN(Number(t)):function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)&&(r=!0),r}function Dt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;Rt(t)||(t=10);var r=Bt();return setTimeout((function(){r.resolve()}),t),r}function $t(t){return"[object Array]"===Object.prototype.toString.call(t)}function Mt(t){var r=Object.prototype.toString.call(t);return"[object Function]"===r||"[object AsyncFunction]"===r}var Gt=function(t){return!0===t||!1===t||O(t)&&"[object Boolean]"==_(t)};function qt(t){return Gt(t)}function Vt(t){return"[object Undefined]"===Object.prototype.toString.call(t)}function Jt(t){return"[object Object]"===Object.prototype.toString.call(t)}function Wt(t){return!!Vt(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(Jt(t)){for(var r in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!Xt(t)||""!==t)}(t)||!!function(t){return!!$t(t)&&0===t.length}(t))))}function Yt(t){return!!$t(t)&&(0!==t.length&&(1!==t.length||!Wt(t[0])))}function Ht(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)}var Kt=function(t,r){return function(e){return t(r(e))}},Qt=Kt(Object.getPrototypeOf,Object),Zt=Function.prototype,tr=Object.prototype,rr=Zt.toString,er=tr.hasOwnProperty,nr=rr.call(Object);var or=function(t){if(!O(t)||"[object Object]"!=_(t))return!1;var r=Qt(t);if(null===r)return!0;var e=er.call(r,"constructor")&&r.constructor;return"function"==typeof e&&e instanceof e&&rr.call(e)==nr};var ar=function(t){return O(t)&&1===t.nodeType&&!or(t)};function ir(t){return ar(t)}function ur(t){var r,e=Object.prototype.toString.call(t);if(r="[object Promise]"===e)return!0;if("[object Function]"!==e)return!1;try{r="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return r}function cr(t,r){return!!Jt(t)&&(!(!Ct(r)&&!Rt(r))&&r in t)}function fr(t,r){var e=new Blob([t],{type:r});try{var n=window.URL.createObjectURL(e);window.open(n)}catch(t){console.log("window.URL.createObjectURL is not support for IE11",t)}}var lr=function(){this.__data__=new st,this.size=0};var sr=function(t){var r=this.__data__,e=r.delete(t);return this.size=r.size,e};var vr=function(t){return this.__data__.get(t)};var pr=function(t){return this.__data__.has(t)};var hr=function(t,r){var e=this.__data__;if(e instanceof st){var n=e.__data__;if(!vt||n.length<199)return n.push([t,r]),this.size=++e.size,this;e=this.__data__=new jt(n)}return e.set(t,r),this.size=e.size,this};function dr(t){var r=this.__data__=new st(t);this.size=r.size}dr.prototype.clear=lr,dr.prototype.delete=sr,dr.prototype.get=vr,dr.prototype.has=pr,dr.prototype.set=hr;var yr=dr;var br=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};var gr=function(t){return this.__data__.has(t)};function mr(t){var r=-1,e=null==t?0:t.length;for(this.__data__=new jt;++r<e;)this.add(t[r])}mr.prototype.add=mr.prototype.push=br,mr.prototype.has=gr;var wr=mr;var jr=function(t,r){for(var e=-1,n=null==t?0:t.length;++e<n;)if(r(t[e],e,t))return!0;return!1};var xr=function(t,r){return t.has(r)};var _r=function(t,r,e,n,o,a){var i=1&e,u=t.length,c=r.length;if(u!=c&&!(i&&c>u))return!1;var f=a.get(t),l=a.get(r);if(f&&l)return f==r&&l==t;var s=-1,v=!0,p=2&e?new wr:void 0;for(a.set(t,r),a.set(r,t);++s<u;){var h=t[s],d=r[s];if(n)var y=i?n(d,h,s,r,t,a):n(h,d,s,t,r,a);if(void 0!==y){if(y)continue;v=!1;break}if(p){if(!jr(r,(function(t,r){if(!xr(p,r)&&(h===t||o(h,t,e,n,a)))return p.push(r)}))){v=!1;break}}else if(h!==d&&!o(h,d,e,n,a)){v=!1;break}}return a.delete(t),a.delete(r),v},Or=p.Uint8Array;var kr=function(t){var r=-1,e=Array(t.size);return t.forEach((function(t,n){e[++r]=[n,t]})),e};var Sr=function(t){var r=-1,e=Array(t.size);return t.forEach((function(t){e[++r]=t})),e},Lr=h?h.prototype:void 0,Ar=Lr?Lr.valueOf:void 0;var Er=function(t,r,e,n,o,a,i){switch(e){case"[object DataView]":if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=r.byteLength||!a(new Or(t),new Or(r)));case"[object Boolean]":case"[object Date]":case"[object Number]":return nt(+t,+r);case"[object Error]":return t.name==r.name&&t.message==r.message;case"[object RegExp]":case"[object String]":return t==r+"";case"[object Map]":var u=kr;case"[object Set]":var c=1&n;if(u||(u=Sr),t.size!=r.size&&!c)return!1;var f=i.get(t);if(f)return f==r;n|=2,i.set(t,r);var l=_r(u(t),u(r),n,o,a,i);return i.delete(t),l;case"[object Symbol]":if(Ar)return Ar.call(t)==Ar.call(r)}return!1};var Pr=function(t,r){for(var e=-1,n=r.length,o=t.length;++e<n;)t[o+e]=r[e];return t};var Tr=function(t,r,e){var n=r(t);return l(t)?n:Pr(n,e(t))};var Nr=function(t,r){for(var e=-1,n=null==t?0:t.length,o=0,a=[];++e<n;){var i=t[e];r(i,e,t)&&(a[o++]=i)}return a};var Fr=function(){return[]},Ir=Object.prototype.propertyIsEnumerable,zr=Object.getOwnPropertySymbols,Ur=zr?function(t){return null==t?[]:(t=Object(t),Nr(zr(t),(function(r){return Ir.call(t,r)})))}:Fr;var Br=function(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n};var Xr=function(t){return O(t)&&"[object Arguments]"==_(t)},Cr=Object.prototype,Rr=Cr.hasOwnProperty,Dr=Cr.propertyIsEnumerable,$r=Xr(function(){return arguments}())?Xr:function(t){return O(t)&&Rr.call(t,"callee")&&!Dr.call(t,"callee")},Mr=$r;var Gr=function(){return!1},qr=u((function(t,r){var e=r&&!r.nodeType&&r,n=e&&t&&!t.nodeType&&t,o=n&&n.exports===e?p.Buffer:void 0,a=(o?o.isBuffer:void 0)||Gr;t.exports=a})),Vr=/^(?:0|[1-9]\d*)$/;var Jr=function(t,r){var e=a(t);return!!(r=null==r?9007199254740991:r)&&("number"==e||"symbol"!=e&&Vr.test(t))&&t>-1&&t%1==0&&t<r};var Wr=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},Yr={};Yr["[object Float32Array]"]=Yr["[object Float64Array]"]=Yr["[object Int8Array]"]=Yr["[object Int16Array]"]=Yr["[object Int32Array]"]=Yr["[object Uint8Array]"]=Yr["[object Uint8ClampedArray]"]=Yr["[object Uint16Array]"]=Yr["[object Uint32Array]"]=!0,Yr["[object Arguments]"]=Yr["[object Array]"]=Yr["[object ArrayBuffer]"]=Yr["[object Boolean]"]=Yr["[object DataView]"]=Yr["[object Date]"]=Yr["[object Error]"]=Yr["[object Function]"]=Yr["[object Map]"]=Yr["[object Number]"]=Yr["[object Object]"]=Yr["[object RegExp]"]=Yr["[object Set]"]=Yr["[object String]"]=Yr["[object WeakMap]"]=!1;var Hr=function(t){return O(t)&&Wr(t.length)&&!!Yr[_(t)]};var Kr=function(t){return function(r){return t(r)}},Qr=u((function(t,r){var e=r&&!r.nodeType&&r,n=e&&t&&!t.nodeType&&t,o=n&&n.exports===e&&s.process,a=function(){try{var t=n&&n.require&&n.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=a})),Zr=Qr&&Qr.isTypedArray,te=Zr?Kr(Zr):Hr,re=Object.prototype.hasOwnProperty;var ee=function(t,r){var e=l(t),n=!e&&Mr(t),o=!e&&!n&&qr(t),a=!e&&!n&&!o&&te(t),i=e||n||o||a,u=i?Br(t.length,String):[],c=u.length;for(var f in t)!r&&!re.call(t,f)||i&&("length"==f||o&&("offset"==f||"parent"==f)||a&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||Jr(f,c))||u.push(f);return u},ne=Object.prototype;var oe=function(t){var r=t&&t.constructor;return t===("function"==typeof r&&r.prototype||ne)},ae=Kt(Object.keys,Object),ie=Object.prototype.hasOwnProperty;var ue=function(t){if(!oe(t))return ae(t);var r=[];for(var e in Object(t))ie.call(t,e)&&"constructor"!=e&&r.push(e);return r};var ce=function(t){return null!=t&&Wr(t.length)&&!T(t)};var fe=function(t){return ce(t)?ee(t):ue(t)};var le=function(t){return Tr(t,fe,Ur)},se=Object.prototype.hasOwnProperty;var ve=function(t,r,e,n,o,a){var i=1&e,u=le(t),c=u.length;if(c!=le(r).length&&!i)return!1;for(var f=c;f--;){var l=u[f];if(!(i?l in r:se.call(r,l)))return!1}var s=a.get(t),v=a.get(r);if(s&&v)return s==r&&v==t;var p=!0;a.set(t,r),a.set(r,t);for(var h=i;++f<c;){var d=t[l=u[f]],y=r[l];if(n)var b=i?n(y,d,l,r,t,a):n(d,y,l,t,r,a);if(!(void 0===b?d===y||o(d,y,e,n,a):b)){p=!1;break}h||(h="constructor"==l)}if(p&&!h){var g=t.constructor,m=r.constructor;g==m||!("constructor"in t)||!("constructor"in r)||"function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m||(p=!1)}return a.delete(t),a.delete(r),p},pe=q(p,"DataView"),he=q(p,"Promise"),de=q(p,"Set"),ye=q(p,"WeakMap"),be="[object Map]",ge="[object Promise]",me="[object Set]",we="[object WeakMap]",je="[object DataView]",xe=U(pe),_e=U(vt),Oe=U(he),ke=U(de),Se=U(ye),Le=_;(pe&&Le(new pe(new ArrayBuffer(1)))!=je||vt&&Le(new vt)!=be||he&&Le(he.resolve())!=ge||de&&Le(new de)!=me||ye&&Le(new ye)!=we)&&(Le=function(t){var r=_(t),e="[object Object]"==r?t.constructor:void 0,n=e?U(e):"";if(n)switch(n){case xe:return je;case _e:return be;case Oe:return ge;case ke:return me;case Se:return we}return r});var Ae=Le,Ee="[object Arguments]",Pe="[object Array]",Te="[object Object]",Ne=Object.prototype.hasOwnProperty;var Fe=function(t,r,e,n,o,a){var i=l(t),u=l(r),c=i?Pe:Ae(t),f=u?Pe:Ae(r),s=(c=c==Ee?Te:c)==Te,v=(f=f==Ee?Te:f)==Te,p=c==f;if(p&&qr(t)){if(!qr(r))return!1;i=!0,s=!1}if(p&&!s)return a||(a=new yr),i||te(t)?_r(t,r,e,n,o,a):Er(t,r,c,e,n,o,a);if(!(1&e)){var h=s&&Ne.call(t,"__wrapped__"),d=v&&Ne.call(r,"__wrapped__");if(h||d){var y=h?t.value():t,b=d?r.value():r;return a||(a=new yr),o(y,b,e,n,a)}}return!!p&&(a||(a=new yr),ve(t,r,e,n,o,a))};var Ie=function t(r,e,n,o,a){return r===e||(null==r||null==e||!O(r)&&!O(e)?r!=r&&e!=e:Fe(r,e,n,o,t,a))};var ze=function(t,r){return Ie(t,r)};function Ue(t,r){function e(t){return $t(t)?t:[t]}if(Wt(t))return!1;if(0===(t=e(t)).length)return!1;if(Wt(t))return!1;if(0===(r=e(r)).length)return!1;for(var n=0;n<t.length;n++)for(var o=0;o<r.length;o++)if(ze(t[n],r[o]))return!0;return!1}var Be=function(t,r){for(var e=-1,n=null==t?0:t.length;++e<n&&!1!==r(t[e],e,t););return t};var Xe=function(t){return function(r,e,n){for(var o=-1,a=Object(r),i=n(r),u=i.length;u--;){var c=i[t?u:++o];if(!1===e(a[c],c,a))break}return r}}();var Ce=function(t,r){return function(e,n){if(null==e)return e;if(!ce(e))return t(e,n);for(var o=e.length,a=r?o:-1,i=Object(e);(r?a--:++a<o)&&!1!==n(i[a],a,i););return e}}((function(t,r){return t&&Xe(t,r,fe)}));var Re=function(t){return t};var De=function(t){return"function"==typeof t?t:Re};var $e=function(t,r){return(l(t)?Be:Ce)(t,De(r))};var Me=function(t,r,e,n){var o=e.length,a=o,i=!n;if(null==t)return!a;for(t=Object(t);o--;){var u=e[o];if(i&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++o<a;){var c=(u=e[o])[0],f=t[c],l=u[1];if(i&&u[2]){if(void 0===f&&!(c in t))return!1}else{var s=new yr;if(n)var v=n(f,l,c,t,r,s);if(!(void 0===v?Ie(l,f,3,n,s):v))return!1}}return!0};var Ge=function(t){return t==t&&!E(t)};var qe=function(t){for(var r=fe(t),e=r.length;e--;){var n=r[e],o=t[n];r[e]=[n,o,Ge(o)]}return r};var Ve=function(t,r){return function(e){return null!=e&&(e[t]===r&&(void 0!==r||t in Object(e)))}};var Je=function(t){var r=qe(t);return 1==r.length&&r[0][2]?Ve(r[0][0],r[0][1]):function(e){return e===t||Me(e,t,r)}};var We=function(t,r){return null!=t&&r in Object(t)};var Ye=function(t,r,e){for(var n=-1,o=(r=Nt(r,t)).length,a=!1;++n<o;){var i=Ft(r[n]);if(!(a=null!=t&&e(t,i)))break;t=t[i]}return a||++n!=o?a:!!(o=null==t?0:t.length)&&Wr(o)&&Jr(i,o)&&(l(t)||Mr(t))};var He=function(t,r){return null!=t&&Ye(t,r,We)};var Ke=function(t,r){return A(t)&&Ge(r)?Ve(Ft(t),r):function(e){var n=zt(e,t);return void 0===n&&n===r?He(e,t):Ie(r,n,3)}};var Qe=function(t){return function(r){return null==r?void 0:r[t]}};var Ze=function(t){return function(r){return It(r,t)}};var tn=function(t){return A(t)?Qe(Ft(t)):Ze(t)};var rn=function(t){return"function"==typeof t?t:null==t?Re:"object"==a(t)?l(t)?Ke(t[0],t[1]):Je(t):tn(t)};var en=function(t,r){var e=-1,n=ce(t)?Array(t.length):[];return Ce(t,(function(t,o,a){n[++e]=r(t,o,a)})),n};var nn=function(t,r){return(l(t)?Lt:en)(t,rn(r))},on=Array.prototype.join;var an=function(t,r){return null==t?"":on.call(t,r)};var un=function(t,r,e){var n=-1,o=t.length;r<0&&(r=-r>o?0:o+r),(e=e>o?o:e)<0&&(e+=o),o=r>e?0:e-r>>>0,r>>>=0;for(var a=Array(o);++n<o;)a[n]=t[n+r];return a},cn=/\s/;var fn=function(t){for(var r=t.length;r--&&cn.test(t.charAt(r)););return r},ln=/^\s+/;var sn=function(t){return t?t.slice(0,fn(t)+1).replace(ln,""):t},vn=/^[-+]0x[0-9a-f]+$/i,pn=/^0b[01]+$/i,hn=/^0o[0-7]+$/i,dn=parseInt;var yn=function(t){if("number"==typeof t)return t;if(k(t))return NaN;if(E(t)){var r="function"==typeof t.valueOf?t.valueOf():t;t=E(r)?r+"":r}if("string"!=typeof t)return 0===t?t:+t;t=sn(t);var e=pn.test(t);return e||hn.test(t)?dn(t.slice(2),e?2:8):vn.test(t)?NaN:+t},bn=1/0;var gn=function(t){return t?(t=yn(t))===bn||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var mn=function(t){var r=gn(t),e=r%1;return r==r?e?r-e:r:0};var wn=function(t,r,e){var n=null==t?0:t.length;return n?(r=e||void 0===r?1:mn(r),un(t,r<0?0:r,n)):[]};var jn=function(t){return"number"==typeof t&&t==mn(t)};function xn(t){return Rt(t)?gn(t):0}function _n(t){return!!Rt(t)&&(t=xn(t),jn(t))}var On=p.isFinite,kn=Math.min;var Sn=function(t){var r=Math[t];return function(t,e){if(t=yn(t),(e=null==e?0:kn(mn(e),292))&&On(t)){var n=(Tt(t)+"e").split("e"),o=r(n[0]+"e"+(+n[1]+e));return+((n=(Tt(o)+"e").split("e"))[0]+"e"+(+n[1]-e))}return r(t)}}("round");function Ln(t){if(!Rt(t))return 0;t=xn(t);var r=Sn(t);return"0"===String(r)?0:r}function An(t){return!!_n(t)&&Ln(t)>0}function En(t){return Pn.apply(this,arguments)}function Pn(){return Pn=o(f.mark((function t(r){var e,n,a,i,u,c,l,s=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=s.length>1&&void 0!==s[1]?s[1]:{},null,n=Bt(),Mt(r)){t.next=6;break}return n.reject("waitfunction需輸入函數f"),t.abrupt("return",n);case 6:return a=function(){var t=o(f.mark((function t(){var e;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!ur(e=r())){t.next=5;break}return t.next=4,e;case 4:e=t.sent;case 5:return t.abrupt("return",e);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.next=9,a();case 9:if(!0!==t.sent){t.next=13;break}return n.resolve(),t.abrupt("return",n);case 13:return An(i=zt(e,"attemptNum",null))||(i=200),An(u=zt(e,"timeInterval",null))||(u=1e3),c=0,l=setInterval(o(f.mark((function t(){return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c+=1,t.next=3,a();case 3:!0===t.sent&&(clearInterval(l),n.resolve()),c>i&&(clearInterval(l),n.resolve());case 6:case"end":return t.stop()}}),t)}))),u),t.abrupt("return",n);case 20:case"end":return t.stop()}}),t)}))),Pn.apply(this,arguments)}function Tn(t,r){if(!Ct(t))return"";if(!(_n(e=r)&&Ln(e)>=0))return"";var e;if(0===(r=Ln(r)))return"";var n=t.length-r;return n<0&&(n=0),t.substr(n,r)}var Nn={},Fn={};function In(t){var r=t.tagName,e=t.path,n=t.attributes,o=void 0===n?{}:n,a=t.func,i=Bt();if("done"===Nn[e])return i.resolve("loaded"),i;if("loading"===Nn[e])return En((function(){return"done"===Nn[e]})).then((function(){i.resolve("loaded")})),i;Nn[e]="loading";var u=document.createElement(r);return $e(o,(function(t,r){u.setAttribute(r,t)})),o.rel&&"stylesheet"===o.rel?(u.setAttribute("href",e),setTimeout((function(){i.resolve(u),Nn[e]="done"}),1)):(u.src=e,u.addEventListener("load",(function(){var t;Mt(a)?t=En(a):(t=Bt()).resolve(),t.then((function(){return Dt(500)})).then((function(){i.resolve(u),Nn[e]="done"}))})),u.addEventListener("error",(function(){i.reject(u),Nn[e]="done"}))),document.getElementsByTagName("head")[0].appendChild(u),i}function zn(t){var r=Bt();$t(t)||(t=[t]),$e(t,(function(r,e){Xt(r)&&(t[e]={path:r})}));var e=an(nn(t,"path"),"|");return"done"===Fn[e]?(r.resolve("loaded"),r):"loading"===Fn[e]?(En((function(){return"done"===Fn[e]})).then((function(){r.resolve("loaded")})),r):(Fn[e]="loading",$e(t,(function(t,r){t.type||(".js"===Tn(t.path,3)?t.type="js":".css"===Tn(t.path,4)?t.type="css":t.type="unknow")})),function(t,r){var e=Bt();if(!$t(t)&&!Jt(t))return e.reject("rs is not an array or object"),e;var n=!1;if(Jt(t)){n=!0;var o=[];$e(t,(function(t,r){o.push({k:r,v:t})})),t=o}Mt(r)||(r=function(t){return t});var a=-1,i=[];return t.reduce((function(t,e){return t.then((function(t){i.push(t);var o=a+=1,u=e;return n&&(o=e.k,u=e.v),Mt(r)?r(u,o):u}))}),Promise.resolve()).then((function(t){i.push(t),i=wn(i),e.resolve(i)})).catch((function(t){e.reject(t)})),e}(t,(function(t){var r=Bt();if("js"===t.type)r=In({tagName:"script",path:t.path,attributes:{type:"text/javascript"},func:t.func});else if("css"===t.type)r=In({tagName:"link",path:t.path,attributes:{rel:"stylesheet"}});else{var e="invalid pathItem.type: "+t.type;console.log(e),r.reject(e)}return r})).finally((function(){Fn[e]="done"})))}function Un(t){function r(t){t.parentNode.removeChild(t)}if(ir(t))r(t);else if(Ct(t)){var e=function(t){return document.querySelectorAll(t)}(t);$e(e,(function(t){r(t)}))}}function Bn(t,r){if(!ir(t))return"invalid eleParent";if(Xt(r))t.insertAdjacentHTML("afterbegin",r);else{if(!ir(r))return"invalid itemChild";t.insertBefore(r,t.firstChild)}}function Xn(){return"undefined"!=typeof window&&void 0!==window.document}function Cn(){return"undefined"!=typeof self?self:Xn()?window:"undefined"!=typeof global?global:null}function Rn(){return Cn().htmlToImage}function Dn(t){return $n.apply(this,arguments)}function $n(){return $n=o(f.mark((function t(r){var e,n,o,a,i,u,c,l,s,v,p=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=p.length>1&&void 0!==p[1]?p[1]:{},ir(r)){t.next=3;break}return t.abrupt("return",Promise.reject("invalid ele"));case 3:if(n=zt(e,"scale",1),Ut(n)){t.next=6;break}return t.abrupt("return",Promise.reject("opt.scale is not a number"));case 6:if(!(n<1)){t.next=8;break}return t.abrupt("return",Promise.reject("opt.scale can not less then 1"));case 8:if("image/jpeg"===(o=zt(e,"picType","image/png"))||"image/png"===o){t.next=11;break}return t.abrupt("return",Promise.reject("opt.picType is not image/jpeg or image/png"));case 11:if(a=zt(e,"toBase64",!0),Gt(a)){t.next=14;break}return t.abrupt("return",Promise.reject("opt.toBase64 is not boolean"));case 14:if(i=r.cloneNode(!0),(u=document.createElement("div")).style.position="absolute",u.style.top=0,u.style.left=0,u.style.zIndex=-1,u.appendChild(i),(c=document.createElement("div")).style.opacity=0,c.style.position="relative",c.appendChild(u),Bn(document.querySelector("body"),c),l=Rn(),v={pixelRatio:n,quality:.95},!a){t.next=42;break}if("image/jpeg"!==o){t.next=36;break}return t.next=33,l.toJpeg(u,v);case 33:s=t.sent,t.next=40;break;case 36:if("image/png"!==o){t.next=40;break}return t.next=39,l.toPng(u,v);case 39:s=t.sent;case 40:t.next=45;break;case 42:return t.next=44,l.toCanvas(u,v);case 44:s=t.sent;case 45:return Un(c),t.abrupt("return",s);case 47:case"end":return t.stop()}}),t)}))),$n.apply(this,arguments)}function Mn(t){return Gn.apply(this,arguments)}function Gn(){return Gn=o(f.mark((function t(r){var e,n,o,a=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.length>1&&void 0!==a[1]?a[1]:{},Yt(n=a.length>2?a[2]:void 0)||(n=["https://cdn.jsdelivr.net/npm/html-to-image@1.9.0/dist/html-to-image.js"]),t.next=5,zn(n);case 5:return o=Dn(r,e),t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)}))),Gn.apply(this,arguments)}var qn=h?h.isConcatSpreadable:void 0;var Vn=function(t){return l(t)||Mr(t)||!!(qn&&t&&t[qn])};var Jn=function t(r,e,n,o,a){var i=-1,u=r.length;for(n||(n=Vn),a||(a=[]);++i<u;){var c=r[i];e>0&&n(c)?e>1?t(c,e-1,n,o,a):Pr(a,c):o||(a[a.length]=c)}return a};var Wn=function(t,r){var e=-1,n=t.length;for(r||(r=Array(n));++e<n;)r[e]=t[e];return r};var Yn=function(){var t=arguments.length;if(!t)return[];for(var r=Array(t-1),e=arguments[0],n=t;n--;)r[n-1]=arguments[n];return Pr(l(e)?Wn(e):[e],Jn(r,1))};function Hn(t){if(Jt(t)){for(var r in t)return!0;return!1}return!1}function Kn(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Qn(t){return function(t){if(Array.isArray(t))return Kn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(t){if("string"==typeof t)return Kn(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Kn(t,r):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Zn=function(t,r,e,n){for(var o=t.length,a=e+(n?1:-1);n?a--:++a<o;)if(r(t[a],a,t))return a;return-1};var to=function(t){return t!=t};var ro=function(t,r,e){for(var n=e-1,o=t.length;++n<o;)if(t[n]===r)return n;return-1};var eo=function(t,r,e){return r==r?ro(t,r,e):Zn(t,to,e)};var no=function(t,r){return!!(null==t?0:t.length)&&eo(t,r,0)>-1};var oo=function(t,r,e){for(var n=-1,o=null==t?0:t.length;++n<o;)if(e(r,t[n]))return!0;return!1};var ao=function(){},io=de&&1/Sr(new de([,-0]))[1]==1/0?function(t){return new de(t)}:ao;var uo=function(t,r,e){var n=-1,o=no,a=t.length,i=!0,u=[],c=u;if(e)i=!1,o=oo;else if(a>=200){var f=r?null:io(t);if(f)return Sr(f);i=!1,o=xr,c=new wr}else c=r?[]:u;t:for(;++n<a;){var l=t[n],s=r?r(l):l;if(l=e||0!==l?l:0,i&&s==s){for(var v=c.length;v--;)if(c[v]===s)continue t;r&&c.push(s),u.push(l)}else o(c,s,e)||(c!==u&&c.push(s),u.push(l))}return u};var co=function(t){return t&&t.length?uo(t):[]};function fo(t){if(!Yt(t))return[];var r=[];return $e(t,(function(t){var e=fe(t);r=[].concat(Qn(r),Qn(e)),r=co(r)})),r}var lo=function(t){return"string"==typeof t||!l(t)&&O(t)&&"[object String]"==_(t)},so=Qe("length"),vo=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var po=function(t){return vo.test(t)},ho="[\\ud800-\\udfff]",yo="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",bo="\\ud83c[\\udffb-\\udfff]",go="[^\\ud800-\\udfff]",mo="(?:\\ud83c[\\udde6-\\uddff]){2}",wo="[\\ud800-\\udbff][\\udc00-\\udfff]",jo="(?:"+yo+"|"+bo+")"+"?",xo="[\\ufe0e\\ufe0f]?",_o=xo+jo+("(?:\\u200d(?:"+[go,mo,wo].join("|")+")"+xo+jo+")*"),Oo="(?:"+[go+yo+"?",yo,mo,wo,ho].join("|")+")",ko=RegExp(bo+"(?="+bo+")|"+Oo+_o,"g");var So=function(t){for(var r=ko.lastIndex=0;ko.test(t);)++r;return r};var Lo=function(t){return po(t)?So(t):so(t)};var Ao=function(t){if(null==t)return 0;if(ce(t))return lo(t)?Lo(t):t.length;var r=Ae(t);return"[object Map]"==r||"[object Set]"==r?t.size:ue(t).length};function Eo(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Vt(t))return"";var e="";try{e=r?JSON.stringify(t,null,2):JSON.stringify(t)}catch(t){e=""}return e}function Po(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Yt(t))return[];if(Yt(r)||(r=fo(t)),0===Ao(r))return[];var e=!1;if($e(t,(function(t){Hn(t)||(e=!0)})),e)return[];var n=[];return $e(t,(function(t){var e=nn(r,(function(r){return qt(t[r])?t[r]?"true":"false":Xt(t[r])||Rt(t[r])?t[r]:Eo(t[r])}));n.push(e)})),n}function To(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!Yt(t))return[];Yt(r)||(r=fo(t)),Hn(e)||(e={},$e(r,(function(t){e[t]=t})));var n=!1;if($e(t,(function(t){Hn(t)||(n=!0)})),n)return[];var o=nn(r,(function(t){return zt(e,t)})),a=Po(t,r),i=Yn([o],a);return i}function No(t,r){if(Xn())if(Ct(t)){var e=document.createElement("a");e.href=r,e.download=t,document.body.appendChild(e),e.click(),document.body.removeChild(e)}else console.log("no filename");else console.log("no window")}function Fo(t,r){Xn()?Ct(t)?null!==navigator.userAgent.toLowerCase().match(/rv:([\d.]+)\) like gecko/)?function(t,r){window.navigator.msSaveOrOpenBlob(r,t)}(t,r):function(t,r){var e=window.URL.createObjectURL(r),n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(e)}(t,r):console.log("no filename"):console.log("no window")}var Io=function(t,r){for(var e=-1,n=null==t?0:t.length;++e<n;)if(!r(t[e],e,t))return!1;return!0};var zo=function(t,r){var e=!0;return Ce(t,(function(t,n,o){return e=!!r(t,n,o)})),e};var Uo=function(t,r,e){if(!E(e))return!1;var n=a(r);return!!("number"==n?ce(e)&&Jr(r,e.length):"string"==n&&r in e)&&nt(e[r],t)};var Bo=function(t,r,e){var n=l(t)?Io:zo;return e&&Uo(t,r,e)&&(r=void 0),n(t,rn(r))};function Xo(){var t=Cn();if(Hn(zt(e.default,"utils")))return e.default;if(Hn(zt(e.default,"default.utils")))return zt(e.default,"default");if(Hn(zt(t,"XLSX.utils")))return zt(t,"XLSX");if(Hn(zt(t,"XLSX.default.utils")))return zt(t,"XLSX.default");if(Hn(zt(t,"xlsx.utils")))return zt(t,"xlsx");if(Hn(zt(t,"xlsx.default.utils")))return zt(t,"xlsx.default");throw console.log("XLSX",e.default,"g.XLSX",t.XLSX,"g.xlsx",t.xlsx),new Error("invalid XLSX, g.XLSX, g.xlsx")}function Co(t){if(!$t(t)&&!ir(t))return{error:"data is not an array or element"};var r=null;try{var e=Xo().utils;if($t(t))Bo(t,Hn)&&(t=To(t)),r=e.aoa_to_sheet(t);else ir(t)&&(r=e.table_to_sheet(t,{raw:!0}))}catch(t){return{error:t}}return r}function Ro(){var t=new function t(){if(!(this instanceof t))return new t;this.SheetNames=[],this.Sheets={}};return t}function Do(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";if(!Jt(t))return{error:"sheet is not an object"};Ct(r)||(r="data");var e=Ro();return e.SheetNames.push(r),e.Sheets[r]=t,e}function $o(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";if(!$t(t)&&!ir(t))return{error:"data is not an array or element"};Ct(r)||(r="data");var e=null,n=Co(t);return cr(n,"error")?n:(cr(e=Do(n,r),"error"),e)}function Mo(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data",e=arguments.length>2?arguments[2]:void 0;if(!Ct(t)){var n="no filename";return console.log(n,t),{error:n}}if(Ct(r)||(r="data"),!$t(e)&&!ir(e)){var o="data is not an array or element";return console.log(o,e),{error:o}}$t(e)&&Hn(zt(e,0,null))&&(e=To(e));var a=$o(e,r);if(zt(a,"error"))return console.log(a.error),a.error;var i=Xo();if(Xn()){var u=i.write(a,{bookType:"xlsx",bookSST:!1,type:"array"});Fo(t,new Blob([u]))}else i.writeFile(a,t);return"ok"}function Go(t){return qo.apply(this,arguments)}function qo(){return qo=o(f.mark((function t(r){var e,n,o,a,i=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.length>1&&void 0!==i[1]?i[1]:"data",n=i.length>2?i[2]:void 0,Yt(o=i.length>3?i[3]:void 0)||(o=["https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"]),t.next=6,zn(o);case 6:if(a=Mo(r,e,n),""===zt(a,"error","")){t.next=9;break}return t.abrupt("return",Promise.reject(a.error));case 9:return t.abrupt("return",a);case 10:case"end":return t.stop()}}),t)}))),qo.apply(this,arguments)}function Vo(t,r){if(Xn())if(Ct(t))if(Ht(r)){var e=function(t){return Ht(t)?new Blob([t]):new Blob}(r);Fo(t,e)}else console.log("no data");else console.log("no filename");else console.log("no window")}return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=zt(r,"keyFunDownloadFileById");Ct(e)||(e="downloadFileById");var n=zt(r,"keyFunUpdateLoading");Ct(n)||(n="updateLoading");var a=zt(r,"keyFunAlert");Ct(a)||(a="alert");var i=zt(r,"useBrowserView");qt(i)||(i=!0);var u=zt(r,"browserViewTypes");Yt(u)||(u=["text/plain","application/rtf","application/json","text/csv","text/html","text/xml","application/xml","application/pdf","image/png","image/jpg","image/jpeg","image/gif","image/bmp","image/svg+xml","image/webp","audio/mpeg","video/mpeg","video/mp4","video/webm"]);var c=zt(r,"textErrorDownloadImage");Ct(c)||(c="無法下載圖片");var l=zt(r,"textErrorDownloadTable");Ct(l)||(l="無法下載表格數據");var s=zt(r,"textErrorDownloadLtdt");Ct(s)||(s="無法下載數據");var v=zt(r,"textInvalidElePic");Ct(v)||(v="elePic非元素");var p=zt(r,"textInvalidEleName");Ct(p)||(p="eleName非元素或字串");var h=zt(r,"textInvalidEleTable");Ct(h)||(h="eleTable非元素");var d=zt(r,"textInvalidLtdt");Ct(d)||(d="ltdt非陣列");var y=zt(r,"textInvalidFileId");Ct(y)||(y="無檔案主鍵");var b=zt(r,"textInvalidKeyFilename");Ct(b)||(b="無檔案名稱主鍵");var g=zt(r,"textInvalidFilename");Ct(g)||(g="無檔案名稱");var m=zt(r,"textInvalidFileU8a");Ct(m)||(m="無檔案內容");var w=zt(r,"textInvalidFileType");Ct(w)||(w="無檔案類型");var j=zt(r,"textDownloadingFile");Ct(j)||(j="開始下載檔案");var x=zt(r,"textDownloadFileSuccessfully");Ct(x)||(x="下載檔案成功");var _=zt(r,"textDownloadFileFailed");function O(){var r=zt(t,e);if(Mt(r))return r.apply(void 0,arguments)}function k(){var r=zt(t,n);if(Mt(r))return r.apply(void 0,arguments)}function S(){var r=zt(t,a);if(Mt(r))return r.apply(void 0,arguments)}function L(t,r){return A.apply(this,arguments)}function A(){return A=o(f.mark((function t(r,e){var n,a,i,u,l,s,h,d,y=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(d=function(){return d=o(f.mark((function t(r,e){var n,o,i,c;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(ir(r)){t.next=2;break}return t.abrupt("return",Promise.reject(v));case 2:if(ir(e)||Ct(e)){t.next=4;break}return t.abrupt("return",Promise.reject(p));case 4:return n="",Ct(n=ir(e)?zt(e,"innerText"):e)||(n=u),o="".concat(n,".png"),"#fff"!==(i=r.style.background)&&(r.style.background="#fff"),t.next=12,Mn(r,{scale:a});case 12:c=t.sent,r.style.background=i,No(o,c);case 15:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)},h=function(t,r){return d.apply(this,arguments)},n=y.length>2&&void 0!==y[2]?y[2]:{},a=zt(n,"scale"),Ut(a)||(a=3),i=zt(n,"timeDelay"),Ut(i)||(i=500),Ct(u=zt(n,"defName"))||(u="pic"),qt(l=zt(n,"useAlert"))||(l=!0),qt(s=zt(n,"useUpdateLoading"))||(s=!0),!s){t.next=17;break}return k(!0),t.next=17,Dt(i);case 17:return t.next=19,h(r,e).catch((function(t){console.log(t),l&&S(c,{type:"error"})})).finally((function(){s&&k(!1)}));case 19:case"end":return t.stop()}}),t)}))),A.apply(this,arguments)}function E(t,r){return P.apply(this,arguments)}function P(){return P=o(f.mark((function t(r,e){var n,a,i,u,c,s,v,d,y=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(d=function(){return d=o(f.mark((function t(r,e){var n,o;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(ir(r)){t.next=2;break}return t.abrupt("return",Promise.reject(h));case 2:if(ir(e)||Ct(e)){t.next=4;break}return t.abrupt("return",Promise.reject(p));case 4:return n="",Ct(n=ir(e)?zt(e,"innerText"):e)||(n=u),o="".concat(n,".xlsx"),t.next=10,Go(o,a,r);case 10:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)},v=function(t,r){return d.apply(this,arguments)},n=y.length>2&&void 0!==y[2]?y[2]:{},Ct(a=zt(n,"nameSheet"))||(a="data"),i=zt(n,"timeDelay"),Ut(i)||(i=500),Ct(u=zt(n,"defName"))||(u="table"),qt(c=zt(n,"useAlert"))||(c=!0),qt(s=zt(n,"useUpdateLoading"))||(s=!0),!s){t.next=17;break}return k(!0),t.next=17,Dt(i);case 17:return t.next=19,v(r,e).catch((function(t){console.log(t),c&&S(l,{type:"error"})})).finally((function(){s&&k(!1)}));case 19:case"end":return t.stop()}}),t)}))),P.apply(this,arguments)}function T(t,r){return N.apply(this,arguments)}function N(){return N=o(f.mark((function t(r,e){var n,a,i,u,c,l,v,h,y=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(h=function(){return h=o(f.mark((function t(r,e){var n,o,i;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if($t(r)){t.next=2;break}return t.abrupt("return",Promise.reject(d));case 2:if(ir(e)||Ct(e)){t.next=4;break}return t.abrupt("return",Promise.reject(p));case 4:return n="",Ct(n=ir(e)?zt(e,"innerText"):e)||(n=u),o="".concat(n,".xlsx"),i=To(r),t.next=11,Go(o,a,i);case 11:case"end":return t.stop()}}),t)}))),h.apply(this,arguments)},v=function(t,r){return h.apply(this,arguments)},n=y.length>2&&void 0!==y[2]?y[2]:{},Ct(a=zt(n,"nameSheet"))||(a="data"),i=zt(n,"timeDelay"),Ut(i)||(i=500),Ct(u=zt(n,"defName"))||(u="table"),qt(c=zt(n,"useAlert"))||(c=!0),qt(l=zt(n,"useUpdateLoading"))||(l=!0),!l){t.next=17;break}return k(!0),t.next=17,Dt(i);case 17:return t.next=19,v(r,e).catch((function(t){console.log(t),c&&S(s,{type:"error"})})).finally((function(){l&&k(!1)}));case 19:case"end":return t.stop()}}),t)}))),N.apply(this,arguments)}function F(t){return I.apply(this,arguments)}function I(){return I=o(f.mark((function t(r){var e,n,a,c,l,s,v,p,h=arguments;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(p=function(){return(p=o(f.mark((function t(){var n,o,c,l,s;return f.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Mt(e)&&e(0),Ct(n=zt(r,"id"))){t.next=5;break}return console.log(y,r),t.abrupt("return",Promise.reject(y));case 5:if(!ur(o=O(n,(function(t){var r=t.prog;t.p,"download"===t.m&&Mt(e)&&e(r)})))){t.next=10;break}return t.next=9,o;case 9:o=t.sent;case 10:if(cr(o,a)){t.next=13;break}return console.log(b,o),t.abrupt("return",Promise.reject(b));case 13:if(Ct(c=zt(o,a,""))){t.next=17;break}return console.log(g,o),t.abrupt("return",Promise.reject(g));case 17:if(Ht(l=zt(o,"u8a"))){t.next=21;break}return console.log(m,o),t.abrupt("return",Promise.reject(m));case 21:if(Vo(c,l),!i){t.next=28;break}if(Ct(s=zt(o,"type"))){t.next=27;break}return console.log(w,o),t.abrupt("return",Promise.reject(w));case 27:Ue(s,u)&&fr(l,s);case 28:case"end":return t.stop()}}),t)})))).apply(this,arguments)},v=function(){return p.apply(this,arguments)},e=h.length>1&&void 0!==h[1]?h[1]:null,n=h.length>2&&void 0!==h[2]?h[2]:{},Ct(a=zt(n,"keyFileName"))||(a="fileName"),c=zt(n,"timeDelay"),Ut(c)||(c=500),qt(l=zt(n,"useAlert"))||(l=!0),qt(s=zt(n,"useUpdateLoading"))||(s=!1),l&&S("".concat(j,": ").concat(r.fileName),{type:"infor"}),!s){t.next=17;break}return k(!0),t.next=17,Dt(c);case 17:return t.next=19,v().then((function(){l&&S("".concat(x,": ").concat(r.name))})).catch((function(t){console.log(t),l&&S("".concat(_,": ").concat(r.name),{type:"error"})})).finally((function(){Mt(e)&&e(null),s&&k(!1)}));case 19:case"end":return t.stop()}}),t)}))),I.apply(this,arguments)}return Ct(_)||(_="下載檔案失敗"),{downloadPic:L,downloadTable:E,downloadLtdt:T,downloadFile:F}}}));
//# sourceMappingURL=w-ui-dwload.umd.js.map
